!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t){var n,i,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var l,u=[],h=!1,c=-1;function d(){h&&l&&(h=!1,l.length?u=l.concat(u):c=-1,u.length&&_())}function _(){if(!h){var e=s(d);h=!0;for(var t=u.length;t;){for(l=u,u=[];++c<t;)l&&l[c].run();c=-1,t=u.length}l=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||h||s(_)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";(function(e){t.js=(()=>n(7)),t.webassembly=((t="./node_modules/jsnet/dist/NetWASM.wasm")=>{e.jsNetWASMPath=t;const i=n(6);return i.Module=n(5),i})}).call(this,n(2))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(function(e){function n(e,t){for(var n=0,i=e.length-1;i>=0;i--){var r=e[i];"."===r?e.splice(i,1):".."===r?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,r=function(e){return i.exec(e).slice(1)};function a(e,t){if(e.filter)return e.filter(t);for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}t.resolve=function(){for(var t="",i=!1,r=arguments.length-1;r>=-1&&!i;r--){var o=r>=0?arguments[r]:e.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,i="/"===o.charAt(0))}return t=n(a(t.split("/"),function(e){return!!e}),!i).join("/"),(i?"/":"")+t||"."},t.normalize=function(e){var i=t.isAbsolute(e),r="/"===o(e,-1);return(e=n(a(e.split("/"),function(e){return!!e}),!i).join("/"))||i||(e="."),e&&r&&(e+="/"),(i?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(a(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var r=i(e.split("/")),a=i(n.split("/")),o=Math.min(r.length,a.length),s=o,l=0;l<o;l++)if(r[l]!==a[l]){s=l;break}var u=[];for(l=s;l<r.length;l++)u.push("..");return(u=u.concat(a.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=r(e),n=t[0],i=t[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},t.basename=function(e,t){var n=r(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return r(e)[3]};var o="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(0))},function(e,t){},function(module,exports,__webpack_require__){(function(process,global){var Module;Module||(Module=(void 0!==Module?Module:null)||{});var moduleOverrides={};for(var key in Module)Module.hasOwnProperty(key)&&(moduleOverrides[key]=Module[key]);var ENVIRONMENT_IS_WEB=!1,ENVIRONMENT_IS_WORKER=!1,ENVIRONMENT_IS_NODE=!1,ENVIRONMENT_IS_SHELL=!1,nodeFS,nodePath;if(Module.ENVIRONMENT)if("WEB"===Module.ENVIRONMENT)ENVIRONMENT_IS_WEB=!0;else if("WORKER"===Module.ENVIRONMENT)ENVIRONMENT_IS_WORKER=!0;else if("NODE"===Module.ENVIRONMENT)ENVIRONMENT_IS_NODE=!0;else{if("SHELL"!==Module.ENVIRONMENT)throw new Error("The provided Module['ENVIRONMENT'] value is not valid. It must be one of: WEB|WORKER|NODE|SHELL.");ENVIRONMENT_IS_SHELL=!0}else ENVIRONMENT_IS_WEB="object"==typeof window,ENVIRONMENT_IS_WORKER="function"==typeof importScripts,ENVIRONMENT_IS_NODE="object"==typeof process&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER,ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE)Module.print||(Module.print=console.log),Module.printErr||(Module.printErr=console.warn),Module.read=function(e,t){nodeFS||(nodeFS=__webpack_require__(4)),nodePath||(nodePath=__webpack_require__(3)),e=nodePath.normalize(e);var n=nodeFS.readFileSync(e);return t?n:n.toString()},Module.readBinary=function(e){var t=Module.read(e,!0);return t.buffer||(t=new Uint8Array(t)),assert(t.buffer),t},Module.load=function(e){globalEval(read(e))},Module.thisProgram||(process.argv.length>1?Module.thisProgram=process.argv[1].replace(/\\/g,"/"):Module.thisProgram="unknown-program"),Module.arguments=process.argv.slice(2),module.exports=Module,process.on("uncaughtException",function(e){if(!(e instanceof ExitStatus))throw e}),Module.inspect=function(){return"[Emscripten Module object]"};else if(ENVIRONMENT_IS_SHELL)Module.print||(Module.print=print),"undefined"!=typeof printErr&&(Module.printErr=printErr),"undefined"!=typeof read?Module.read=read:Module.read=function(){throw"no read() available"},Module.readBinary=function(e){if("function"==typeof readbuffer)return new Uint8Array(readbuffer(e));var t=read(e,"binary");return assert("object"==typeof t),t},"undefined"!=typeof scriptArgs?Module.arguments=scriptArgs:void 0!==arguments&&(Module.arguments=arguments),"function"==typeof quit&&(Module.quit=function(e,t){quit(e)});else{if(!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER)throw"Unknown runtime environment. Where are we?";if(Module.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},ENVIRONMENT_IS_WORKER&&(Module.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),Module.readAsync=function(e,t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){200==i.status||0==i.status&&i.response?t(i.response):n()},i.onerror=n,i.send(null)},void 0!==arguments&&(Module.arguments=arguments),"undefined"!=typeof console)Module.print||(Module.print=function(e){console.log(e)}),Module.printErr||(Module.printErr=function(e){console.warn(e)});else{var TRY_USE_DUMP=!1;Module.print||(Module.print=TRY_USE_DUMP&&"undefined"!=typeof dump?function(e){dump(e)}:function(e){})}ENVIRONMENT_IS_WORKER&&(Module.load=importScripts),void 0===Module.setWindowTitle&&(Module.setWindowTitle=function(e){document.title=e})}function globalEval(e){eval.call(null,e)}for(var key in!Module.load&&Module.read&&(Module.load=function(e){globalEval(Module.read(e))}),Module.print||(Module.print=function(){}),Module.printErr||(Module.printErr=Module.print),Module.arguments||(Module.arguments=[]),Module.thisProgram||(Module.thisProgram="./this.program"),Module.quit||(Module.quit=function(e,t){throw t}),Module.print=Module.print,Module.printErr=Module.printErr,Module.preRun=[],Module.postRun=[],moduleOverrides)moduleOverrides.hasOwnProperty(key)&&(Module[key]=moduleOverrides[key]);moduleOverrides=void 0;var Runtime={setTempRet0:function(e){return tempRet0=e,e},getTempRet0:function(){return tempRet0},stackSave:function(){return STACKTOP},stackRestore:function(e){STACKTOP=e},getNativeTypeSize:function(e){switch(e){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===e[e.length-1])return Runtime.QUANTUM_SIZE;if("i"===e[0]){var t=parseInt(e.substr(1));return assert(t%8==0),t/8}return 0}},getNativeFieldSize:function(e){return Math.max(Runtime.getNativeTypeSize(e),Runtime.QUANTUM_SIZE)},STACK_ALIGN:16,prepVararg:function(e,t){return"double"===t||"i64"===t?7&e&&(assert(4==(7&e)),e+=4):assert(0==(3&e)),e},getAlignSize:function(e,t,n){return n||"i64"!=e&&"double"!=e?e?Math.min(t||(e?Runtime.getNativeFieldSize(e):0),Runtime.QUANTUM_SIZE):Math.min(t,8):8},dynCall:function(e,t,n){return n&&n.length?Module["dynCall_"+e].apply(null,[t].concat(n)):Module["dynCall_"+e].call(null,t)},functionPointers:[],addFunction:function(e){for(var t=0;t<Runtime.functionPointers.length;t++)if(!Runtime.functionPointers[t])return Runtime.functionPointers[t]=e,2*(1+t);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},removeFunction:function(e){Runtime.functionPointers[(e-2)/2]=null},warnOnce:function(e){Runtime.warnOnce.shown||(Runtime.warnOnce.shown={}),Runtime.warnOnce.shown[e]||(Runtime.warnOnce.shown[e]=1,Module.printErr(e))},funcWrappers:{},getFuncWrapper:function(e,t){assert(t),Runtime.funcWrappers[t]||(Runtime.funcWrappers[t]={});var n=Runtime.funcWrappers[t];return n[e]||(1===t.length?n[e]=function(){return Runtime.dynCall(t,e)}:2===t.length?n[e]=function(n){return Runtime.dynCall(t,e,[n])}:n[e]=function(){return Runtime.dynCall(t,e,Array.prototype.slice.call(arguments))}),n[e]},getCompilerSetting:function(e){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},stackAlloc:function(e){var t=STACKTOP;return STACKTOP=(STACKTOP=STACKTOP+e|0)+15&-16,t},staticAlloc:function(e){var t=STATICTOP;return STATICTOP=(STATICTOP=STATICTOP+e|0)+15&-16,t},dynamicAlloc:function(e){var t=HEAP32[DYNAMICTOP_PTR>>2],n=-16&(t+e+15|0);if((HEAP32[DYNAMICTOP_PTR>>2]=n,n>=TOTAL_MEMORY)&&!enlargeMemory())return HEAP32[DYNAMICTOP_PTR>>2]=t,0;return t},alignMemory:function(e,t){return e=Math.ceil(e/(t||16))*(t||16)},makeBigInt:function(e,t,n){return n?+(e>>>0)+4294967296*+(t>>>0):+(e>>>0)+4294967296*+(0|t)},GLOBAL_BASE:1024,QUANTUM_SIZE:4,__dummy__:0};Module.Runtime=Runtime;var ABORT=0,EXITSTATUS=0,cwrap,ccall;function assert(e,t){e||abort("Assertion failed: "+t)}function getCFunc(ident){var func=Module["_"+ident];if(!func)try{func=eval("_"+ident)}catch(e){}return assert(func,"Cannot call unknown function "+ident+" (perhaps LLVM optimizations or closure removed it?)"),func}function setValue(e,t,n,i){switch("*"===(n=n||"i8").charAt(n.length-1)&&(n="i32"),n){case"i1":case"i8":HEAP8[e>>0]=t;break;case"i16":HEAP16[e>>1]=t;break;case"i32":HEAP32[e>>2]=t;break;case"i64":tempI64=[t>>>0,(tempDouble=t,+Math_abs(tempDouble)>=1?tempDouble>0?(0|Math_min(+Math_floor(tempDouble/4294967296),4294967295))>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[e>>2]=tempI64[0],HEAP32[e+4>>2]=tempI64[1];break;case"float":HEAPF32[e>>2]=t;break;case"double":HEAPF64[e>>3]=t;break;default:abort("invalid type for setValue: "+n)}}function getValue(e,t,n){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return HEAP8[e>>0];case"i16":return HEAP16[e>>1];case"i32":case"i64":return HEAP32[e>>2];case"float":return HEAPF32[e>>2];case"double":return HEAPF64[e>>3];default:abort("invalid type for setValue: "+t)}return null}!function(){var JSfuncs={stackSave:function(){Runtime.stackSave()},stackRestore:function(){Runtime.stackRestore()},arrayToC:function(e){var t=Runtime.stackAlloc(e.length);return writeArrayToMemory(e,t),t},stringToC:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var n=1+(e.length<<2);stringToUTF8(e,t=Runtime.stackAlloc(n),n)}return t}},toC={string:JSfuncs.stringToC,array:JSfuncs.arrayToC};ccall=function(e,t,n,i,r){var a=getCFunc(e),o=[],s=0;if(i)for(var l=0;l<i.length;l++){var u=toC[n[l]];u?(0===s&&(s=Runtime.stackSave()),o[l]=u(i[l])):o[l]=i[l]}var h=a.apply(null,o);if("string"===t&&(h=Pointer_stringify(h)),0!==s){if(r&&r.async)return void EmterpreterAsync.asyncFinalizers.push(function(){Runtime.stackRestore(s)});Runtime.stackRestore(s)}return h};var sourceRegex=/^function\s*[a-zA-Z$_0-9]*\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/;function parseJSFunc(e){var t=e.toString().match(sourceRegex).slice(1);return{arguments:t[0],body:t[1],returnValue:t[2]}}var JSsource=null;function ensureJSsource(){if(!JSsource)for(var e in JSsource={},JSfuncs)JSfuncs.hasOwnProperty(e)&&(JSsource[e]=parseJSFunc(JSfuncs[e]))}cwrap=function cwrap(ident,returnType,argTypes){argTypes=argTypes||[];var cfunc=getCFunc(ident),numericArgs=argTypes.every(function(e){return"number"===e}),numericRet="string"!==returnType;if(numericRet&&numericArgs)return cfunc;var argNames=argTypes.map(function(e,t){return"$"+t}),funcstr="(function("+argNames.join(",")+") {",nargs=argTypes.length;if(!numericArgs){ensureJSsource(),funcstr+="var stack = "+JSsource.stackSave.body+";";for(var i=0;i<nargs;i++){var arg=argNames[i],type=argTypes[i];if("number"!==type){var convertCode=JSsource[type+"ToC"];funcstr+="var "+convertCode.arguments+" = "+arg+";",funcstr+=convertCode.body+";",funcstr+=arg+"=("+convertCode.returnValue+");"}}}var cfuncname=parseJSFunc(function(){return cfunc}).returnValue;if(funcstr+="var ret = "+cfuncname+"("+argNames.join(",")+");",!numericRet){var strgfy=parseJSFunc(function(){return Pointer_stringify}).returnValue;funcstr+="ret = "+strgfy+"(ret);"}return numericArgs||(ensureJSsource(),funcstr+=JSsource.stackRestore.body.replace("()","(stack)")+";"),funcstr+="return ret})",eval(funcstr)}}(),Module.ccall=ccall,Module.cwrap=cwrap,Module.setValue=setValue,Module.getValue=getValue;var ALLOC_NORMAL=0,ALLOC_STACK=1,ALLOC_STATIC=2,ALLOC_DYNAMIC=3,ALLOC_NONE=4;function allocate(e,t,n,i){var r,a;"number"==typeof e?(r=!0,a=e):(r=!1,a=e.length);var o,s="string"==typeof t?t:null;if(o=n==ALLOC_NONE?i:["function"==typeof _malloc?_malloc:Runtime.staticAlloc,Runtime.stackAlloc,Runtime.staticAlloc,Runtime.dynamicAlloc][void 0===n?ALLOC_STATIC:n](Math.max(a,s?1:t.length)),r){var l;i=o;for(assert(0==(3&o)),l=o+(-4&a);i<l;i+=4)HEAP32[i>>2]=0;for(l=o+a;i<l;)HEAP8[i++>>0]=0;return o}if("i8"===s)return e.subarray||e.slice?HEAPU8.set(e,o):HEAPU8.set(new Uint8Array(e),o),o;for(var u,h,c,d=0;d<a;){var _=e[d];"function"==typeof _&&(_=Runtime.getFunctionIndex(_)),0!==(u=s||t[d])?("i64"==u&&(u="i32"),setValue(o+d,_,u),c!==u&&(h=Runtime.getNativeTypeSize(u),c=u),d+=h):d++}return o}function getMemory(e){return staticSealed?runtimeInitialized?_malloc(e):Runtime.dynamicAlloc(e):Runtime.staticAlloc(e)}function Pointer_stringify(e,t){if(0===t||!e)return"";for(var n,i=0,r=0;i|=n=HEAPU8[e+r>>0],(0!=n||t)&&(r++,!t||r!=t););t||(t=r);var a="";if(i<128){for(var o;t>0;)o=String.fromCharCode.apply(String,HEAPU8.subarray(e,e+Math.min(t,1024))),a=a?a+o:o,e+=1024,t-=1024;return a}return Module.UTF8ToString(e)}function AsciiToString(e){for(var t="";;){var n=HEAP8[e++>>0];if(!n)return t;t+=String.fromCharCode(n)}}function stringToAscii(e,t){return writeAsciiToMemory(e,t,!1)}Module.ALLOC_NORMAL=ALLOC_NORMAL,Module.ALLOC_STACK=ALLOC_STACK,Module.ALLOC_STATIC=ALLOC_STATIC,Module.ALLOC_DYNAMIC=ALLOC_DYNAMIC,Module.ALLOC_NONE=ALLOC_NONE,Module.allocate=allocate,Module.getMemory=getMemory,Module.Pointer_stringify=Pointer_stringify,Module.AsciiToString=AsciiToString,Module.stringToAscii=stringToAscii;var UTF8Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function UTF8ArrayToString(e,t){for(var n=t;e[n];)++n;if(n-t>16&&e.subarray&&UTF8Decoder)return UTF8Decoder.decode(e.subarray(t,n));for(var i,r,a,o,s,l="";;){if(!(i=e[t++]))return l;if(128&i)if(r=63&e[t++],192!=(224&i))if(a=63&e[t++],224==(240&i)?i=(15&i)<<12|r<<6|a:(o=63&e[t++],240==(248&i)?i=(7&i)<<18|r<<12|a<<6|o:(s=63&e[t++],i=248==(252&i)?(3&i)<<24|r<<18|a<<12|o<<6|s:(1&i)<<30|r<<24|a<<18|o<<12|s<<6|63&e[t++])),i<65536)l+=String.fromCharCode(i);else{var u=i-65536;l+=String.fromCharCode(55296|u>>10,56320|1023&u)}else l+=String.fromCharCode((31&i)<<6|r);else l+=String.fromCharCode(i)}}function UTF8ToString(e){return UTF8ArrayToString(HEAPU8,e)}function stringToUTF8Array(e,t,n,i){if(!(i>0))return 0;for(var r=n,a=n+i-1,o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o)),s<=127){if(n>=a)break;t[n++]=s}else if(s<=2047){if(n+1>=a)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(n+2>=a)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else if(s<=2097151){if(n+3>=a)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}else if(s<=67108863){if(n+4>=a)break;t[n++]=248|s>>24,t[n++]=128|s>>18&63,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(n+5>=a)break;t[n++]=252|s>>30,t[n++]=128|s>>24&63,t[n++]=128|s>>18&63,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}}return t[n]=0,n-r}function stringToUTF8(e,t,n){return stringToUTF8Array(e,HEAPU8,t,n)}function lengthBytesUTF8(e){for(var t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++n)),i<=127?++t:t+=i<=2047?2:i<=65535?3:i<=2097151?4:i<=67108863?5:6}return t}Module.UTF8ArrayToString=UTF8ArrayToString,Module.UTF8ToString=UTF8ToString,Module.stringToUTF8Array=stringToUTF8Array,Module.stringToUTF8=stringToUTF8,Module.lengthBytesUTF8=lengthBytesUTF8;var UTF16Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function demangle(e){var t=Module.___cxa_demangle||Module.__cxa_demangle;if(t){try{var n=e.substr(1),i=lengthBytesUTF8(n)+1,r=_malloc(i);stringToUTF8(n,r,i);var a=_malloc(4),o=t(r,0,0,a);if(0===getValue(a,"i32")&&o)return Pointer_stringify(o)}catch(e){}finally{r&&_free(r),a&&_free(a),o&&_free(o)}return e}return Runtime.warnOnce("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),e}function demangleAll(e){return e.replace(/__Z[\w\d_]+/g,function(e){var t=demangle(e);return e===t?e:e+" ["+t+"]"})}function jsStackTrace(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function stackTrace(){var e=jsStackTrace();return Module.extraStackTrace&&(e+="\n"+Module.extraStackTrace()),demangleAll(e)}Module.stackTrace=stackTrace;var WASM_PAGE_SIZE=65536,ASMJS_PAGE_SIZE=16777216,MIN_TOTAL_MEMORY=16777216,HEAP,buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64,STATIC_BASE,STATICTOP,staticSealed,STACK_BASE,STACKTOP,STACK_MAX,DYNAMIC_BASE,DYNAMICTOP_PTR,byteLength;function alignUp(e,t){return e%t>0&&(e+=t-e%t),e}function updateGlobalBuffer(e){Module.buffer=buffer=e}function updateGlobalBufferViews(){Module.HEAP8=HEAP8=new Int8Array(buffer),Module.HEAP16=HEAP16=new Int16Array(buffer),Module.HEAP32=HEAP32=new Int32Array(buffer),Module.HEAPU8=HEAPU8=new Uint8Array(buffer),Module.HEAPU16=HEAPU16=new Uint16Array(buffer),Module.HEAPU32=HEAPU32=new Uint32Array(buffer),Module.HEAPF32=HEAPF32=new Float32Array(buffer),Module.HEAPF64=HEAPF64=new Float64Array(buffer)}function abortOnCannotGrowMemory(){abort("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+TOTAL_MEMORY+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function enlargeMemory(){var e=Module.usingWasm?WASM_PAGE_SIZE:ASMJS_PAGE_SIZE,t=2147483648-e;if(HEAP32[DYNAMICTOP_PTR>>2]>t)return!1;var n=TOTAL_MEMORY;for(TOTAL_MEMORY=Math.max(TOTAL_MEMORY,MIN_TOTAL_MEMORY);TOTAL_MEMORY<HEAP32[DYNAMICTOP_PTR>>2];)TOTAL_MEMORY=TOTAL_MEMORY<=536870912?alignUp(2*TOTAL_MEMORY,e):Math.min(alignUp((3*TOTAL_MEMORY+2147483648)/4,e),t);var i=Module.reallocBuffer(TOTAL_MEMORY);return i&&i.byteLength==TOTAL_MEMORY?(updateGlobalBuffer(i),updateGlobalBufferViews(),!0):(TOTAL_MEMORY=n,!1)}STATIC_BASE=STATICTOP=STACK_BASE=STACKTOP=STACK_MAX=DYNAMIC_BASE=DYNAMICTOP_PTR=0,staticSealed=!1,Module.reallocBuffer||(Module.reallocBuffer=function(e){var t;try{if(ArrayBuffer.transfer)t=ArrayBuffer.transfer(buffer,e);else{var n=HEAP8;t=new ArrayBuffer(e),new Int8Array(t).set(n)}}catch(e){return!1}return!!_emscripten_replace_memory(t)&&t});try{byteLength=Function.prototype.call.bind(Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength").get),byteLength(new ArrayBuffer(4))}catch(e){byteLength=function(e){return e.byteLength}}var TOTAL_STACK=Module.TOTAL_STACK||5242880,TOTAL_MEMORY=Module.TOTAL_MEMORY||16777216;function getTotalMemory(){return TOTAL_MEMORY}if(TOTAL_MEMORY<TOTAL_STACK&&Module.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+TOTAL_MEMORY+"! (TOTAL_STACK="+TOTAL_STACK+")"),Module.buffer?buffer=Module.buffer:"object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(Module.wasmMemory=new WebAssembly.Memory({initial:TOTAL_MEMORY/WASM_PAGE_SIZE}),buffer=Module.wasmMemory.buffer):buffer=new ArrayBuffer(TOTAL_MEMORY),updateGlobalBufferViews(),HEAP32[0]=1668509029,HEAP16[1]=25459,115!==HEAPU8[2]||99!==HEAPU8[3])throw"Runtime error: expected the system to be little-endian!";function callRuntimeCallbacks(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?Module.dynCall_v(n):Module.dynCall_vi(n,t.arg):n(void 0===t.arg?null:t.arg)}else t()}}Module.HEAP=HEAP,Module.buffer=buffer,Module.HEAP8=HEAP8,Module.HEAP16=HEAP16,Module.HEAP32=HEAP32,Module.HEAPU8=HEAPU8,Module.HEAPU16=HEAPU16,Module.HEAPU32=HEAPU32,Module.HEAPF32=HEAPF32,Module.HEAPF64=HEAPF64;var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATEXIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1,runtimeExited=!1;function preRun(){if(Module.preRun)for("function"==typeof Module.preRun&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){runtimeInitialized||(runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__))}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__),runtimeExited=!0}function postRun(){if(Module.postRun)for("function"==typeof Module.postRun&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(e){__ATPRERUN__.unshift(e)}function addOnInit(e){__ATINIT__.unshift(e)}function addOnPreMain(e){__ATMAIN__.unshift(e)}function addOnExit(e){__ATEXIT__.unshift(e)}function addOnPostRun(e){__ATPOSTRUN__.unshift(e)}function intArrayFromString(e,t,n){var i=n>0?n:lengthBytesUTF8(e)+1,r=new Array(i),a=stringToUTF8Array(e,r,0,r.length);return t&&(r.length=a),r}function intArrayToString(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];i>255&&(i&=255),t.push(String.fromCharCode(i))}return t.join("")}function writeStringToMemory(e,t,n){var i,r;Runtime.warnOnce("writeStringToMemory is deprecated and should not be called! Use stringToUTF8() instead!"),n&&(r=t+lengthBytesUTF8(e),i=HEAP8[r]),stringToUTF8(e,t,1/0),n&&(HEAP8[r]=i)}function writeArrayToMemory(e,t){HEAP8.set(e,t)}function writeAsciiToMemory(e,t,n){for(var i=0;i<e.length;++i)HEAP8[t++>>0]=e.charCodeAt(i);n||(HEAP8[t>>0]=0)}if(Module.addOnPreRun=addOnPreRun,Module.addOnInit=addOnInit,Module.addOnPreMain=addOnPreMain,Module.addOnExit=addOnExit,Module.addOnPostRun=addOnPostRun,Module.intArrayFromString=intArrayFromString,Module.intArrayToString=intArrayToString,Module.writeStringToMemory=writeStringToMemory,Module.writeArrayToMemory=writeArrayToMemory,Module.writeAsciiToMemory=writeAsciiToMemory,Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(e,t){var n=65535&e,i=65535&t;return n*i+((e>>>16)*i+n*(t>>>16)<<16)|0}),Math.imul=Math.imul,!Math.fround){var froundBuffer=new Float32Array(1);Math.fround=function(e){return froundBuffer[0]=e,froundBuffer[0]}}Math.fround=Math.fround,Math.clz32||(Math.clz32=function(e){e>>>=0;for(var t=0;t<32;t++)if(e&1<<31-t)return t;return 32}),Math.clz32=Math.clz32,Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)}),Math.trunc=Math.trunc;var Math_abs=Math.abs,Math_cos=Math.cos,Math_sin=Math.sin,Math_tan=Math.tan,Math_acos=Math.acos,Math_asin=Math.asin,Math_atan=Math.atan,Math_atan2=Math.atan2,Math_exp=Math.exp,Math_log=Math.log,Math_sqrt=Math.sqrt,Math_ceil=Math.ceil,Math_floor=Math.floor,Math_pow=Math.pow,Math_imul=Math.imul,Math_fround=Math.fround,Math_round=Math.round,Math_min=Math.min,Math_clz32=Math.clz32,Math_trunc=Math.trunc,runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function addRunDependency(e){runDependencies++,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}function removeRunDependency(e){if(runDependencies--,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies),0==runDependencies&&(null!==runDependencyWatcher&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var t=dependenciesFulfilled;dependenciesFulfilled=null,t()}}Module.addRunDependency=addRunDependency,Module.removeRunDependency=removeRunDependency,Module.preloadedImages={},Module.preloadedAudios={};var memoryInitializer=null;function integrateWasmJS(e){var t=e.wasmJSMethod||"native-wasm";e.wasmJSMethod=t;var n=e.wasmTextFile||"NetWASM.wast",i=e.wasmBinaryFile||global.jsNetWASMPath,r=e.asmjsCodeFile||"NetWASM.temp.asm.js";"function"==typeof e.locateFile&&(n=e.locateFile(n),i=e.locateFile(i),r=e.locateFile(r));var a={global:null,env:null,asm2wasm:{"f64-rem":function(e,t){return e%t},"f64-to-int":function(e){return 0|e},"i32s-div":function(e,t){return(0|e)/(0|t)|0},"i32u-div":function(e,t){return(e>>>0)/(t>>>0)>>>0},"i32s-rem":function(e,t){return(0|e)%(0|t)|0},"i32u-rem":function(e,t){return(e>>>0)%(t>>>0)>>>0},debugger:function(){}},parent:e},o=null;function s(e){return e}function l(){return e.wasmBinary||"function"!=typeof fetch?new Promise(function(t,n){t(function(){try{var t;if(e.wasmBinary)t=e.wasmBinary,t=new Uint8Array(t);else{if(!e.readBinary)throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)";t=e.readBinary(i)}return t}catch(e){abort(e)}}())}):fetch(i,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+i+"'";return e.arrayBuffer()})}function u(t,n,i){if("object"!=typeof WebAssembly)return e.printErr("no native wasm support detected"),!1;if(!(e.wasmMemory instanceof WebAssembly.Memory))return e.printErr("no native wasm Memory in use"),!1;function r(t){(o=t.exports).memory&&function(t){var n=e.buffer;t.byteLength<n.byteLength&&e.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here");var i=new Int8Array(n),r=new Int8Array(t);memoryInitializer||i.set(r.subarray(e.STATIC_BASE,e.STATIC_BASE+e.STATIC_BUMP),e.STATIC_BASE),r.set(i),updateGlobalBuffer(t),updateGlobalBufferViews()}(o.memory),e.asm=o,e.usingWasm=!0,removeRunDependency("wasm-instantiate")}if(n.memory=e.wasmMemory,a.global={NaN:NaN,Infinity:1/0},a["global.Math"]=t.Math,a.env=n,addRunDependency("wasm-instantiate"),e.instantiateWasm)try{return e.instantiateWasm(a,r)}catch(t){return e.printErr("Module.instantiateWasm callback failed with error: "+t),!1}return l().then(function(e){return WebAssembly.instantiate(e,a)}).then(function(e){r(e.instance)}).catch(function(t){e.printErr("failed to asynchronously prepare wasm: "+t),abort(t)}),{}}e.asmPreload=e.asm;var h=e.reallocBuffer;e.reallocBuffer=function(t){return"asmjs"===c?h(t):function(t){t=alignUp(t,e.usingWasm?WASM_PAGE_SIZE:ASMJS_PAGE_SIZE);var n=e.buffer,i=n.byteLength;if(!e.usingWasm)return o.__growWasmMemory((t-i)/65536),e.buffer!==n?e.buffer:null;try{return-1!==e.wasmMemory.grow((t-i)/65536)?e.buffer=e.wasmMemory.buffer:null}catch(e){return null}}(t)};var c="";e.asm=function(t,n,i){if(t=s(t),!(n=s(n)).table){var r=e.wasmTableSize;void 0===r&&(r=1024);var a=e.wasmMaxTableSize;"object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?n.table=void 0!==a?new WebAssembly.Table({initial:r,maximum:a,element:"anyfunc"}):new WebAssembly.Table({initial:r,element:"anyfunc"}):n.table=new Array(r),e.wasmTable=n.table}return n.memoryBase||(n.memoryBase=e.STATIC_BASE),n.tableBase||(n.tableBase=0),u(t,n)};e.asm}integrateWasmJS(Module);var ASM_CONSTS=[function(){"undefined"!=typeof window&&(window.dispatchEvent(new CustomEvent("jsNetWASMLoaded")),window.global=window.global||{}),global.onWASMLoaded&&global.onWASMLoaded()}];function _emscripten_asm_const_i(e){return ASM_CONSTS[e]()}STATIC_BASE=Runtime.GLOBAL_BASE,STATICTOP=STATIC_BASE+7040,__ATINIT__.push({func:function(){__GLOBAL__sub_I_emscripten_cpp()}}),memoryInitializer=Module.wasmJSMethod.indexOf("asmjs")>=0||Module.wasmJSMethod.indexOf("interpret-asm2wasm")>=0?"NetWASM.js.mem":null;var STATIC_BUMP=7040;Module.STATIC_BASE=STATIC_BASE,Module.STATIC_BUMP=STATIC_BUMP;var tempDoublePtr=STATICTOP;function ___cxa_pure_virtual(){throw ABORT=!0,"Pure virtual function called!"}function __ZSt18uncaught_exceptionv(){return!!__ZSt18uncaught_exceptionv.uncaught_exception}STATICTOP+=16;var EXCEPTIONS={last:0,caught:[],infos:{},deAdjust:function(e){if(!e||EXCEPTIONS.infos[e])return e;for(var t in EXCEPTIONS.infos){if(EXCEPTIONS.infos[t].adjusted===e)return t}return e},addRef:function(e){e&&EXCEPTIONS.infos[e].refcount++},decRef:function(e){if(e){var t=EXCEPTIONS.infos[e];assert(t.refcount>0),t.refcount--,0!==t.refcount||t.rethrown||(t.destructor&&Module.dynCall_vi(t.destructor,e),delete EXCEPTIONS.infos[e],___cxa_free_exception(e))}},clearRef:function(e){e&&(EXCEPTIONS.infos[e].refcount=0)}};function ___resumeException(e){throw EXCEPTIONS.last||(EXCEPTIONS.last=e),e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function ___cxa_find_matching_catch(){var e=EXCEPTIONS.last;if(!e)return 0|(Runtime.setTempRet0(0),0);var t=EXCEPTIONS.infos[e],n=t.type;if(!n)return 0|(Runtime.setTempRet0(0),e);var i=Array.prototype.slice.call(arguments);Module.___cxa_is_pointer_type(n);___cxa_find_matching_catch.buffer||(___cxa_find_matching_catch.buffer=_malloc(4)),HEAP32[___cxa_find_matching_catch.buffer>>2]=e,e=___cxa_find_matching_catch.buffer;for(var r=0;r<i.length;r++)if(i[r]&&Module.___cxa_can_catch(i[r],n,e))return e=HEAP32[e>>2],t.adjusted=e,0|(Runtime.setTempRet0(i[r]),e);return e=HEAP32[e>>2],0|(Runtime.setTempRet0(n),e)}function ___cxa_throw(e,t,n){throw EXCEPTIONS.infos[e]={ptr:e,adjusted:e,type:t,destructor:n,refcount:0,caught:!1,rethrown:!1},EXCEPTIONS.last=e,"uncaught_exception"in __ZSt18uncaught_exceptionv?__ZSt18uncaught_exceptionv.uncaught_exception++:__ZSt18uncaught_exceptionv.uncaught_exception=1,e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function _abort(){Module.abort()}function ___cxa_begin_catch(e){var t=EXCEPTIONS.infos[e];return t&&!t.caught&&(t.caught=!0,__ZSt18uncaught_exceptionv.uncaught_exception--),t&&(t.rethrown=!1),EXCEPTIONS.caught.push(e),EXCEPTIONS.addRef(EXCEPTIONS.deAdjust(e)),e}function _pthread_once(e,t){_pthread_once.seen||(_pthread_once.seen={}),e in _pthread_once.seen||(Module.dynCall_v(t),_pthread_once.seen[e]=1)}function _emscripten_memcpy_big(e,t,n){return HEAPU8.set(HEAPU8.subarray(t,t+n),e),e}var PTHREAD_SPECIFIC={};function _pthread_getspecific(e){return PTHREAD_SPECIFIC[e]||0}function _llvm_stackrestore(e){var t=_llvm_stacksave,n=t.LLVM_SAVEDSTACKS[e];t.LLVM_SAVEDSTACKS.splice(e,1),Runtime.stackRestore(n)}function ___setErrNo(e){return Module.___errno_location&&(HEAP32[Module.___errno_location()>>2]=e),e}function _llvm_stacksave(){var e=_llvm_stacksave;return e.LLVM_SAVEDSTACKS||(e.LLVM_SAVEDSTACKS=[]),e.LLVM_SAVEDSTACKS.push(Runtime.stackSave()),e.LLVM_SAVEDSTACKS.length-1}var PTHREAD_SPECIFIC_NEXT_KEY=1,ERRNO_CODES={EPERM:1,ENOENT:2,ESRCH:3,EINTR:4,EIO:5,ENXIO:6,E2BIG:7,ENOEXEC:8,EBADF:9,ECHILD:10,EAGAIN:11,EWOULDBLOCK:11,ENOMEM:12,EACCES:13,EFAULT:14,ENOTBLK:15,EBUSY:16,EEXIST:17,EXDEV:18,ENODEV:19,ENOTDIR:20,EISDIR:21,EINVAL:22,ENFILE:23,EMFILE:24,ENOTTY:25,ETXTBSY:26,EFBIG:27,ENOSPC:28,ESPIPE:29,EROFS:30,EMLINK:31,EPIPE:32,EDOM:33,ERANGE:34,ENOMSG:42,EIDRM:43,ECHRNG:44,EL2NSYNC:45,EL3HLT:46,EL3RST:47,ELNRNG:48,EUNATCH:49,ENOCSI:50,EL2HLT:51,EDEADLK:35,ENOLCK:37,EBADE:52,EBADR:53,EXFULL:54,ENOANO:55,EBADRQC:56,EBADSLT:57,EDEADLOCK:35,EBFONT:59,ENOSTR:60,ENODATA:61,ETIME:62,ENOSR:63,ENONET:64,ENOPKG:65,EREMOTE:66,ENOLINK:67,EADV:68,ESRMNT:69,ECOMM:70,EPROTO:71,EMULTIHOP:72,EDOTDOT:73,EBADMSG:74,ENOTUNIQ:76,EBADFD:77,EREMCHG:78,ELIBACC:79,ELIBBAD:80,ELIBSCN:81,ELIBMAX:82,ELIBEXEC:83,ENOSYS:38,ENOTEMPTY:39,ENAMETOOLONG:36,ELOOP:40,EOPNOTSUPP:95,EPFNOSUPPORT:96,ECONNRESET:104,ENOBUFS:105,EAFNOSUPPORT:97,EPROTOTYPE:91,ENOTSOCK:88,ENOPROTOOPT:92,ESHUTDOWN:108,ECONNREFUSED:111,EADDRINUSE:98,ECONNABORTED:103,ENETUNREACH:101,ENETDOWN:100,ETIMEDOUT:110,EHOSTDOWN:112,EHOSTUNREACH:113,EINPROGRESS:115,EALREADY:114,EDESTADDRREQ:89,EMSGSIZE:90,EPROTONOSUPPORT:93,ESOCKTNOSUPPORT:94,EADDRNOTAVAIL:99,ENETRESET:102,EISCONN:106,ENOTCONN:107,ETOOMANYREFS:109,EUSERS:87,EDQUOT:122,ESTALE:116,ENOTSUP:95,ENOMEDIUM:123,EILSEQ:84,EOVERFLOW:75,ECANCELED:125,ENOTRECOVERABLE:131,EOWNERDEAD:130,ESTRPIPE:86};function _pthread_key_create(e,t){return 0==e?ERRNO_CODES.EINVAL:(HEAP32[e>>2]=PTHREAD_SPECIFIC_NEXT_KEY,PTHREAD_SPECIFIC[PTHREAD_SPECIFIC_NEXT_KEY]=0,PTHREAD_SPECIFIC_NEXT_KEY++,0)}function ___gxx_personality_v0(){}var SYSCALLS={varargs:0,get:function(e){return SYSCALLS.varargs+=4,HEAP32[SYSCALLS.varargs-4>>2]},getStr:function(){return Pointer_stringify(SYSCALLS.get())},get64:function(){var e=SYSCALLS.get(),t=SYSCALLS.get();return assert(e>=0?0===t:-1===t),e},getZero:function(){assert(0===SYSCALLS.get())}};function ___syscall146(e,t){SYSCALLS.varargs=t;try{var n=SYSCALLS.get(),i=SYSCALLS.get(),r=SYSCALLS.get(),a=0;___syscall146.buffer||(___syscall146.buffers=[null,[],[]],___syscall146.printChar=function(e,t){var n=___syscall146.buffers[e];assert(n),0===t||10===t?((1===e?Module.print:Module.printErr)(UTF8ArrayToString(n,0)),n.length=0):n.push(t)});for(var o=0;o<r;o++){for(var s=HEAP32[i+8*o>>2],l=HEAP32[i+(8*o+4)>>2],u=0;u<l;u++)___syscall146.printChar(n,HEAPU8[s+u]);a+=l}return a}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function _pthread_setspecific(e,t){return e in PTHREAD_SPECIFIC?(PTHREAD_SPECIFIC[e]=t,0):ERRNO_CODES.EINVAL}var _llvm_pow_f64=Math_pow;function ___syscall140(e,t){SYSCALLS.varargs=t;try{var n=SYSCALLS.getStreamFromFD(),i=(SYSCALLS.get(),SYSCALLS.get()),r=SYSCALLS.get(),a=SYSCALLS.get(),o=i;return FS.llseek(n,o,a),HEAP32[r>>2]=n.position,n.getdents&&0===o&&0===a&&(n.getdents=null),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function ___syscall6(e,t){SYSCALLS.varargs=t;try{var n=SYSCALLS.getStreamFromFD();return FS.close(n),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function ___cxa_allocate_exception(e){return _malloc(e)}function ___syscall54(e,t){SYSCALLS.varargs=t;try{return 0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||abort(e),-e.errno}}function invoke_iiii(e,t,n,i){try{return Module.dynCall_iiii(e,t,n,i)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_dii(e,t,n){try{return Module.dynCall_dii(e,t,n)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_viiiii(e,t,n,i,r,a){try{Module.dynCall_viiiii(e,t,n,i,r,a)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_vi(e,t){try{Module.dynCall_vi(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_vii(e,t,n){try{Module.dynCall_vii(e,t,n)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_ii(e,t){try{return Module.dynCall_ii(e,t)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_v(e){try{Module.dynCall_v(e)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_viiiiii(e,t,n,i,r,a,o){try{Module.dynCall_viiiiii(e,t,n,i,r,a,o)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_ddii(e,t,n,i){try{return Module.dynCall_ddii(e,t,n,i)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}function invoke_viiii(e,t,n,i,r){try{Module.dynCall_viiii(e,t,n,i,r)}catch(e){if("number"!=typeof e&&"longjmp"!==e)throw e;Module.setThrew(1,0)}}__ATEXIT__.push(function(){var e=Module._fflush;e&&e(0);var t=___syscall146.printChar;if(t){var n=___syscall146.buffers;n[1].length&&t(1,10),n[2].length&&t(2,10)}}),DYNAMICTOP_PTR=allocate(1,"i32",ALLOC_STATIC),STACK_BASE=STACKTOP=Runtime.alignMemory(STATICTOP),STACK_MAX=STACK_BASE+TOTAL_STACK,DYNAMIC_BASE=Runtime.alignMemory(STACK_MAX),HEAP32[DYNAMICTOP_PTR>>2]=DYNAMIC_BASE,staticSealed=!0,Module.wasmTableSize=156,Module.wasmMaxTableSize=156,Module.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0,byteLength:byteLength},Module.asmLibraryArg={abort:abort,assert:assert,enlargeMemory:enlargeMemory,getTotalMemory:getTotalMemory,abortOnCannotGrowMemory:abortOnCannotGrowMemory,invoke_iiii:invoke_iiii,invoke_dii:invoke_dii,invoke_viiiii:invoke_viiiii,invoke_vi:invoke_vi,invoke_vii:invoke_vii,invoke_ii:invoke_ii,invoke_v:invoke_v,invoke_viiiiii:invoke_viiiiii,invoke_ddii:invoke_ddii,invoke_viiii:invoke_viiii,_llvm_pow_f64:_llvm_pow_f64,___syscall54:___syscall54,_abort:_abort,___gxx_personality_v0:___gxx_personality_v0,_llvm_stackrestore:_llvm_stackrestore,___cxa_allocate_exception:___cxa_allocate_exception,___cxa_find_matching_catch:___cxa_find_matching_catch,_emscripten_asm_const_i:_emscripten_asm_const_i,___setErrNo:___setErrNo,___cxa_begin_catch:___cxa_begin_catch,_emscripten_memcpy_big:_emscripten_memcpy_big,___resumeException:___resumeException,__ZSt18uncaught_exceptionv:__ZSt18uncaught_exceptionv,_pthread_getspecific:_pthread_getspecific,_llvm_stacksave:_llvm_stacksave,_pthread_once:_pthread_once,_pthread_key_create:_pthread_key_create,_pthread_setspecific:_pthread_setspecific,___cxa_throw:___cxa_throw,___syscall6:___syscall6,___syscall140:___syscall140,___cxa_pure_virtual:___cxa_pure_virtual,___syscall146:___syscall146,DYNAMICTOP_PTR:DYNAMICTOP_PTR,tempDoublePtr:tempDoublePtr,ABORT:ABORT,STACKTOP:STACKTOP,STACK_MAX:STACK_MAX};var asm=Module.asm(Module.asmGlobalArg,Module.asmLibraryArg,buffer);Module.asm=asm;var _get_filter_dropoutMap=Module._get_filter_dropoutMap=function(){return Module.asm._get_filter_dropoutMap.apply(null,arguments)},_set_pool_channels=Module._set_pool_channels=function(){return Module.asm._set_pool_channels.apply(null,arguments)},_get_stoppedEarly=Module._get_stoppedEarly=function(){return Module.asm._get_stoppedEarly.apply(null,arguments)},_set_momentum=Module._set_momentum=function(){return Module.asm._set_momentum.apply(null,arguments)},_get_neuron_weightsCache=Module._get_neuron_weightsCache=function(){return Module.asm._get_neuron_weightsCache.apply(null,arguments)},_getLearningRate=Module._getLearningRate=function(){return Module.asm._getLearningRate.apply(null,arguments)},_get_conv_filterSize=Module._get_conv_filterSize=function(){return Module.asm._get_conv_filterSize.apply(null,arguments)},_get_l1=Module._get_l1=function(){return Module.asm._get_l1.apply(null,arguments)},_loadValidationData=Module._loadValidationData=function(){return Module.asm._loadValidationData.apply(null,arguments)},_get_filter_v=Module._get_filter_v=function(){return Module.asm._get_filter_v.apply(null,arguments)},_set_filter_biasCache=Module._set_filter_biasCache=function(){return Module.asm._set_filter_biasCache.apply(null,arguments)},_get_maxNormTotal=Module._get_maxNormTotal=function(){return Module.asm._get_maxNormTotal.apply(null,arguments)},_sbrk=Module._sbrk=function(){return Module.asm._sbrk.apply(null,arguments)},_memcpy=Module._memcpy=function(){return Module.asm._memcpy.apply(null,arguments)},stackSave=Module.stackSave=function(){return Module.asm.stackSave.apply(null,arguments)},_get_filter_m=Module._get_filter_m=function(){return Module.asm._get_filter_m.apply(null,arguments)},_set_earlyStoppingBestError=Module._set_earlyStoppingBestError=function(){return Module.asm._set_earlyStoppingBestError.apply(null,arguments)},_get_rho=Module._get_rho=function(){return Module.asm._get_rho.apply(null,arguments)},stackAlloc=Module.stackAlloc=function(){return Module.asm.stackAlloc.apply(null,arguments)},_addConvLayer=Module._addConvLayer=function(){return Module.asm._addConvLayer.apply(null,arguments)},_set_conv_inZPMapValuesCount=Module._set_conv_inZPMapValuesCount=function(){return Module.asm._set_conv_inZPMapValuesCount.apply(null,arguments)},_get_filter_weightsCache=Module._get_filter_weightsCache=function(){return Module.asm._get_filter_weightsCache.apply(null,arguments)},_set_filter_v=Module._set_filter_v=function(){return Module.asm._set_filter_v.apply(null,arguments)},_get_conv_zeroPadding=Module._get_conv_zeroPadding=function(){return Module.asm._get_conv_zeroPadding.apply(null,arguments)},_get_l2Error=Module._get_l2Error=function(){return Module.asm._get_l2Error.apply(null,arguments)},_get_l2=Module._get_l2=function(){return Module.asm._get_l2.apply(null,arguments)},_emscripten_get_global_libc=Module._emscripten_get_global_libc=function(){return Module.asm._emscripten_get_global_libc.apply(null,arguments)},_set_filter_m=Module._set_filter_m=function(){return Module.asm._set_filter_m.apply(null,arguments)},_set_l1Error=Module._set_l1Error=function(){return Module.asm._set_l1Error.apply(null,arguments)},_set_iterations=Module._set_iterations=function(){return Module.asm._set_iterations.apply(null,arguments)},_get_neuron_error=Module._get_neuron_error=function(){return Module.asm._get_neuron_error.apply(null,arguments)},_set_filter_weightGain=Module._set_filter_weightGain=function(){return Module.asm._set_filter_weightGain.apply(null,arguments)},_set_neuron_adadeltaBiasCache=Module._set_neuron_adadeltaBiasCache=function(){return Module.asm._set_neuron_adadeltaBiasCache.apply(null,arguments)},_get_collected_training=Module._get_collected_training=function(){return Module.asm._get_collected_training.apply(null,arguments)},___cxa_can_catch=Module.___cxa_can_catch=function(){return Module.asm.___cxa_can_catch.apply(null,arguments)},_free=Module._free=function(){return Module.asm._free.apply(null,arguments)},runPostSets=Module.runPostSets=function(){return Module.asm.runPostSets.apply(null,arguments)},_set_neuron_biasGain=Module._set_neuron_biasGain=function(){return Module.asm._set_neuron_biasGain.apply(null,arguments)},_set_conv_filterSize=Module._set_conv_filterSize=function(){return Module.asm._set_conv_filterSize.apply(null,arguments)},_train=Module._train=function(){return Module.asm._train.apply(null,arguments)},_get_filter_deltaWeights=Module._get_filter_deltaWeights=function(){return Module.asm._get_filter_deltaWeights.apply(null,arguments)},_get_filter_weights=Module._get_filter_weights=function(){return Module.asm._get_filter_weights.apply(null,arguments)},_get_filter_sumMap=Module._get_filter_sumMap=function(){return Module.asm._get_filter_sumMap.apply(null,arguments)},_get_validationInterval=Module._get_validationInterval=function(){return Module.asm._get_validationInterval.apply(null,arguments)},_set_neuron_sum=Module._set_neuron_sum=function(){return Module.asm._set_neuron_sum.apply(null,arguments)},_get_pool_activation=Module._get_pool_activation=function(){return Module.asm._get_pool_activation.apply(null,arguments)},_set_filter_activationMap=Module._set_filter_activationMap=function(){return Module.asm._set_filter_activationMap.apply(null,arguments)},_set_conv_activation=Module._set_conv_activation=function(){return Module.asm._set_conv_activation.apply(null,arguments)},_get_filter_weightGain=Module._get_filter_weightGain=function(){return Module.asm._get_filter_weightGain.apply(null,arguments)},_get_pool_indeces=Module._get_pool_indeces=function(){return Module.asm._get_pool_indeces.apply(null,arguments)},_get_pool_inMapValuesCount=Module._get_pool_inMapValuesCount=function(){return Module.asm._get_pool_inMapValuesCount.apply(null,arguments)},_initLayers=Module._initLayers=function(){return Module.asm._initLayers.apply(null,arguments)},_get_neuron_bias=Module._get_neuron_bias=function(){return Module.asm._get_neuron_bias.apply(null,arguments)},setThrew=Module.setThrew=function(){return Module.asm.setThrew.apply(null,arguments)},_get_filter_activationMap=Module._get_filter_activationMap=function(){return Module.asm._get_filter_activationMap.apply(null,arguments)},_set_earlyStoppingThreshold=Module._set_earlyStoppingThreshold=function(){return Module.asm._set_earlyStoppingThreshold.apply(null,arguments)},_set_neuron_weightsCache=Module._set_neuron_weightsCache=function(){return Module.asm._set_neuron_weightsCache.apply(null,arguments)},_get_filter_errorMap=Module._get_filter_errorMap=function(){return Module.asm._get_filter_errorMap.apply(null,arguments)},_get_momentum=Module._get_momentum=function(){return Module.asm._get_momentum.apply(null,arguments)},_set_dropout=Module._set_dropout=function(){return Module.asm._set_dropout.apply(null,arguments)},_get_conv_inZPMapValuesCount=Module._get_conv_inZPMapValuesCount=function(){return Module.asm._get_conv_inZPMapValuesCount.apply(null,arguments)},_get_dropout=Module._get_dropout=function(){return Module.asm._get_dropout.apply(null,arguments)},___cxa_is_pointer_type=Module.___cxa_is_pointer_type=function(){return Module.asm.___cxa_is_pointer_type.apply(null,arguments)},_set_fc_activation=Module._set_fc_activation=function(){return Module.asm._set_fc_activation.apply(null,arguments)},_get_filter_adadeltaWeightsCache=Module._get_filter_adadeltaWeightsCache=function(){return Module.asm._get_filter_adadeltaWeightsCache.apply(null,arguments)},_set_filter_errorMap=Module._set_filter_errorMap=function(){return Module.asm._set_filter_errorMap.apply(null,arguments)},_set_earlyStoppingPatience=Module._set_earlyStoppingPatience=function(){return Module.asm._set_earlyStoppingPatience.apply(null,arguments)},_set_neuron_weightGain=Module._set_neuron_weightGain=function(){return Module.asm._set_neuron_weightGain.apply(null,arguments)},_get_eluAlpha=Module._get_eluAlpha=function(){return Module.asm._get_eluAlpha.apply(null,arguments)},_get_updateFn=Module._get_updateFn=function(){return Module.asm._get_updateFn.apply(null,arguments)},_set_neuron_dropped=Module._set_neuron_dropped=function(){return Module.asm._set_neuron_dropped.apply(null,arguments)},_get_stdDeviation=Module._get_stdDeviation=function(){return Module.asm._get_stdDeviation.apply(null,arguments)},getTempRet0=Module.getTempRet0=function(){return Module.asm.getTempRet0.apply(null,arguments)},_set_maxNormTotal=Module._set_maxNormTotal=function(){return Module.asm._set_maxNormTotal.apply(null,arguments)},_set_pool_inMapValuesCount=Module._set_pool_inMapValuesCount=function(){return Module.asm._set_pool_inMapValuesCount.apply(null,arguments)},_set_pool_activation=Module._set_pool_activation=function(){return Module.asm._set_pool_activation.apply(null,arguments)},_get_pool_channels=Module._get_pool_channels=function(){return Module.asm._get_pool_channels.apply(null,arguments)},_set_miniBatchSize=Module._set_miniBatchSize=function(){return Module.asm._set_miniBatchSize.apply(null,arguments)},_get_pool_errors=Module._get_pool_errors=function(){return Module.asm._get_pool_errors.apply(null,arguments)},_get_neuron_adadeltaBiasCache=Module._get_neuron_adadeltaBiasCache=function(){return Module.asm._get_neuron_adadeltaBiasCache.apply(null,arguments)},_shuffleTrainingData=Module._shuffleTrainingData=function(){return Module.asm._shuffleTrainingData.apply(null,arguments)},_set_trainingLogging=Module._set_trainingLogging=function(){return Module.asm._set_trainingLogging.apply(null,arguments)},_llvm_bswap_i32=Module._llvm_bswap_i32=function(){return Module.asm._llvm_bswap_i32.apply(null,arguments)},_get_filter_adadeltaBiasCache=Module._get_filter_adadeltaBiasCache=function(){return Module.asm._get_filter_adadeltaBiasCache.apply(null,arguments)},_get_collected_test=Module._get_collected_test=function(){return Module.asm._get_collected_test.apply(null,arguments)},_set_filter_deltaWeights=Module._set_filter_deltaWeights=function(){return Module.asm._set_filter_deltaWeights.apply(null,arguments)},_get_earlyStoppingPatience=Module._get_earlyStoppingPatience=function(){return Module.asm._get_earlyStoppingPatience.apply(null,arguments)},_get_validationConfusionMatrix=Module._get_validationConfusionMatrix=function(){return Module.asm._get_validationConfusionMatrix.apply(null,arguments)},_get_neuron_weights=Module._get_neuron_weights=function(){return Module.asm._get_neuron_weights.apply(null,arguments)},stackRestore=Module.stackRestore=function(){return Module.asm.stackRestore.apply(null,arguments)},_set_filter_bias=Module._set_filter_bias=function(){return Module.asm._set_filter_bias.apply(null,arguments)},_set_validationInterval=Module._set_validationInterval=function(){return Module.asm._set_validationInterval.apply(null,arguments)},_get_iterations=Module._get_iterations=function(){return Module.asm._get_iterations.apply(null,arguments)},_get_earlyStoppingPatienceCounter=Module._get_earlyStoppingPatienceCounter=function(){return Module.asm._get_earlyStoppingPatienceCounter.apply(null,arguments)},_set_neuron_bias=Module._set_neuron_bias=function(){return Module.asm._set_neuron_bias.apply(null,arguments)},_setActivation=Module._setActivation=function(){return Module.asm._setActivation.apply(null,arguments)},_get_lreluSlope=Module._get_lreluSlope=function(){return Module.asm._get_lreluSlope.apply(null,arguments)},_setCostFunction=Module._setCostFunction=function(){return Module.asm._setCostFunction.apply(null,arguments)},_set_neuron_m=Module._set_neuron_m=function(){return Module.asm._set_neuron_m.apply(null,arguments)},_test=Module._test=function(){return Module.asm._test.apply(null,arguments)},_set_stoppedEarly=Module._set_stoppedEarly=function(){return Module.asm._set_stoppedEarly.apply(null,arguments)},_set_filter_weights=Module._set_filter_weights=function(){return Module.asm._set_filter_weights.apply(null,arguments)},_set_pool_outMapSize=Module._set_pool_outMapSize=function(){return Module.asm._set_pool_outMapSize.apply(null,arguments)},establishStackSpace=Module.establishStackSpace=function(){return Module.asm.establishStackSpace.apply(null,arguments)},_get_trainingConfusionMatrix=Module._get_trainingConfusionMatrix=function(){return Module.asm._get_trainingConfusionMatrix.apply(null,arguments)},_set_validations=Module._set_validations=function(){return Module.asm._set_validations.apply(null,arguments)},_get_pool_activations=Module._get_pool_activations=function(){return Module.asm._get_pool_activations.apply(null,arguments)},_main=Module._main=function(){return Module.asm._main.apply(null,arguments)},_getValidationError=Module._getValidationError=function(){return Module.asm._getValidationError.apply(null,arguments)},_set_l2=Module._set_l2=function(){return Module.asm._set_l2.apply(null,arguments)},_set_l1=Module._set_l1=function(){return Module.asm._set_l1.apply(null,arguments)},_addPoolLayer=Module._addPoolLayer=function(){return Module.asm._addPoolLayer.apply(null,arguments)},_get_rmsDecay=Module._get_rmsDecay=function(){return Module.asm._get_rmsDecay.apply(null,arguments)},_set_neuron_activation=Module._set_neuron_activation=function(){return Module.asm._set_neuron_activation.apply(null,arguments)},_set_l2Error=Module._set_l2Error=function(){return Module.asm._set_l2Error.apply(null,arguments)},_get_neuron_deltaWeights=Module._get_neuron_deltaWeights=function(){return Module.asm._get_neuron_deltaWeights.apply(null,arguments)},_get_neuron_sum=Module._get_neuron_sum=function(){return Module.asm._get_neuron_sum.apply(null,arguments)},_set_conv_inMapValuesCount=Module._set_conv_inMapValuesCount=function(){return Module.asm._set_conv_inMapValuesCount.apply(null,arguments)},_set_neuron_deltaBias=Module._set_neuron_deltaBias=function(){return Module.asm._set_neuron_deltaBias.apply(null,arguments)},_set_pool_prevLayerOutWidth=Module._set_pool_prevLayerOutWidth=function(){return Module.asm._set_pool_prevLayerOutWidth.apply(null,arguments)},_get_pool_outMapSize=Module._get_pool_outMapSize=function(){return Module.asm._get_pool_outMapSize.apply(null,arguments)},_set_conv_stride=Module._set_conv_stride=function(){return Module.asm._set_conv_stride.apply(null,arguments)},_get_fc_activation=Module._get_fc_activation=function(){return Module.asm._get_fc_activation.apply(null,arguments)},_set_maxNorm=Module._set_maxNorm=function(){return Module.asm._set_maxNorm.apply(null,arguments)},_set_neuron_error=Module._set_neuron_error=function(){return Module.asm._set_neuron_error.apply(null,arguments)},_get_pool_prevLayerOutWidth=Module._get_pool_prevLayerOutWidth=function(){return Module.asm._get_pool_prevLayerOutWidth.apply(null,arguments)},_addFCLayer=Module._addFCLayer=function(){return Module.asm._addFCLayer.apply(null,arguments)},_set_rho=Module._set_rho=function(){return Module.asm._set_rho.apply(null,arguments)},_set_earlyStoppingPatienceCounter=Module._set_earlyStoppingPatienceCounter=function(){return Module.asm._set_earlyStoppingPatienceCounter.apply(null,arguments)},_get_conv_activation=Module._get_conv_activation=function(){return Module.asm._get_conv_activation.apply(null,arguments)},setTempRet0=Module.setTempRet0=function(){return Module.asm.setTempRet0.apply(null,arguments)},_get_earlyStoppingType=Module._get_earlyStoppingType=function(){return Module.asm._get_earlyStoppingType.apply(null,arguments)},_set_conv_outMapSize=Module._set_conv_outMapSize=function(){return Module.asm._set_conv_outMapSize.apply(null,arguments)},_get_conv_stride=Module._get_conv_stride=function(){return Module.asm._get_conv_stride.apply(null,arguments)},_set_neuron_v=Module._set_neuron_v=function(){return Module.asm._set_neuron_v.apply(null,arguments)},_get_maxNorm=Module._get_maxNorm=function(){return Module.asm._get_maxNorm.apply(null,arguments)},_get_conv_channels=Module._get_conv_channels=function(){return Module.asm._get_conv_channels.apply(null,arguments)},_set_lreluSlope=Module._set_lreluSlope=function(){return Module.asm._set_lreluSlope.apply(null,arguments)},_loadTestingData=Module._loadTestingData=function(){return Module.asm._loadTestingData.apply(null,arguments)},_get_neuron_biasGain=Module._get_neuron_biasGain=function(){return Module.asm._get_neuron_biasGain.apply(null,arguments)},_get_neuron_adadeltaCache=Module._get_neuron_adadeltaCache=function(){return Module.asm._get_neuron_adadeltaCache.apply(null,arguments)},_set_rmsDecay=Module._set_rmsDecay=function(){return Module.asm._set_rmsDecay.apply(null,arguments)},_setLearningRate=Module._setLearningRate=function(){return Module.asm._setLearningRate.apply(null,arguments)},_set_filter_biasGain=Module._set_filter_biasGain=function(){return Module.asm._set_filter_biasGain.apply(null,arguments)},_get_earlyStoppingBestError=Module._get_earlyStoppingBestError=function(){return Module.asm._get_earlyStoppingBestError.apply(null,arguments)},_get_filter_bias=Module._get_filter_bias=function(){return Module.asm._get_filter_bias.apply(null,arguments)},_getError=Module._getError=function(){return Module.asm._getError.apply(null,arguments)},_get_neuron_derivative=Module._get_neuron_derivative=function(){return Module.asm._get_neuron_derivative.apply(null,arguments)},_get_filter_biasGain=Module._get_filter_biasGain=function(){return Module.asm._get_filter_biasGain.apply(null,arguments)},_loadTrainingData=Module._loadTrainingData=function(){return Module.asm._loadTrainingData.apply(null,arguments)},_set_filter_sumMap=Module._set_filter_sumMap=function(){return Module.asm._set_filter_sumMap.apply(null,arguments)},_emscripten_replace_memory=Module._emscripten_replace_memory=function(){return Module.asm._emscripten_replace_memory.apply(null,arguments)},_get_channels=Module._get_channels=function(){return Module.asm._get_channels.apply(null,arguments)},_get_l1Error=Module._get_l1Error=function(){return Module.asm._get_l1Error.apply(null,arguments)},_newNetwork=Module._newNetwork=function(){return Module.asm._newNetwork.apply(null,arguments)},_set_distribution=Module._set_distribution=function(){return Module.asm._set_distribution.apply(null,arguments)},_set_pool_stride=Module._set_pool_stride=function(){return Module.asm._set_pool_stride.apply(null,arguments)},_collectErrors=Module._collectErrors=function(){return Module.asm._collectErrors.apply(null,arguments)},_restoreValidation=Module._restoreValidation=function(){return Module.asm._restoreValidation.apply(null,arguments)},_set_neuron_adadeltaCache=Module._set_neuron_adadeltaCache=function(){return Module.asm._set_neuron_adadeltaCache.apply(null,arguments)},_get_neuron_activation=Module._get_neuron_activation=function(){return Module.asm._get_neuron_activation.apply(null,arguments)},_set_limit=Module._set_limit=function(){return Module.asm._set_limit.apply(null,arguments)},_set_eluAlpha=Module._set_eluAlpha=function(){return Module.asm._set_eluAlpha.apply(null,arguments)},_set_pool_errors=Module._set_pool_errors=function(){return Module.asm._set_pool_errors.apply(null,arguments)},_set_mean=Module._set_mean=function(){return Module.asm._set_mean.apply(null,arguments)},_get_filter_deltaBias=Module._get_filter_deltaBias=function(){return Module.asm._get_filter_deltaBias.apply(null,arguments)},_set_neuron_weights=Module._set_neuron_weights=function(){return Module.asm._set_neuron_weights.apply(null,arguments)},_get_neuron_weightGain=Module._get_neuron_weightGain=function(){return Module.asm._get_neuron_weightGain.apply(null,arguments)},_set_channels=Module._set_channels=function(){return Module.asm._set_channels.apply(null,arguments)},_set_earlyStoppingPercent=Module._set_earlyStoppingPercent=function(){return Module.asm._set_earlyStoppingPercent.apply(null,arguments)},_get_earlyStoppingThreshold=Module._get_earlyStoppingThreshold=function(){return Module.asm._get_earlyStoppingThreshold.apply(null,arguments)},_get_neuron_biasCache=Module._get_neuron_biasCache=function(){return Module.asm._get_neuron_biasCache.apply(null,arguments)},_get_distribution=Module._get_distribution=function(){return Module.asm._get_distribution.apply(null,arguments)},_set_earlyStoppingType=Module._set_earlyStoppingType=function(){return Module.asm._set_earlyStoppingType.apply(null,arguments)},_get_testConfusionMatrix=Module._get_testConfusionMatrix=function(){return Module.asm._get_testConfusionMatrix.apply(null,arguments)},_set_pool_activations=Module._set_pool_activations=function(){return Module.asm._set_pool_activations.apply(null,arguments)},_get_trainingLogging=Module._get_trainingLogging=function(){return Module.asm._get_trainingLogging.apply(null,arguments)},_set_conv_zeroPadding=Module._set_conv_zeroPadding=function(){return Module.asm._set_conv_zeroPadding.apply(null,arguments)},_set_filter_dropoutMap=Module._set_filter_dropoutMap=function(){return Module.asm._set_filter_dropoutMap.apply(null,arguments)},_set_filter_adadeltaBiasCache=Module._set_filter_adadeltaBiasCache=function(){return Module.asm._set_filter_adadeltaBiasCache.apply(null,arguments)},_set_filter_weightsCache=Module._set_filter_weightsCache=function(){return Module.asm._set_filter_weightsCache.apply(null,arguments)},_set_filter_deltaBias=Module._set_filter_deltaBias=function(){return Module.asm._set_filter_deltaBias.apply(null,arguments)},_get_neuron_deltaBias=Module._get_neuron_deltaBias=function(){return Module.asm._get_neuron_deltaBias.apply(null,arguments)},_memset=Module._memset=function(){return Module.asm._memset.apply(null,arguments)},_get_filter_biasCache=Module._get_filter_biasCache=function(){return Module.asm._get_filter_biasCache.apply(null,arguments)},_set_neuron_biasCache=Module._set_neuron_biasCache=function(){return Module.asm._set_neuron_biasCache.apply(null,arguments)},_get_validations=Module._get_validations=function(){return Module.asm._get_validations.apply(null,arguments)},_get_earlyStoppingPercent=Module._get_earlyStoppingPercent=function(){return Module.asm._get_earlyStoppingPercent.apply(null,arguments)},_get_mean=Module._get_mean=function(){return Module.asm._get_mean.apply(null,arguments)},_get_collected_validation=Module._get_collected_validation=function(){return Module.asm._get_collected_validation.apply(null,arguments)},_getLastValidationError=Module._getLastValidationError=function(){return Module.asm._getLastValidationError.apply(null,arguments)},_set_neuron_deltaWeights=Module._set_neuron_deltaWeights=function(){return Module.asm._set_neuron_deltaWeights.apply(null,arguments)},_get_neuron_dropped=Module._get_neuron_dropped=function(){return Module.asm._get_neuron_dropped.apply(null,arguments)},__GLOBAL__sub_I_emscripten_cpp=Module.__GLOBAL__sub_I_emscripten_cpp=function(){return Module.asm.__GLOBAL__sub_I_emscripten_cpp.apply(null,arguments)},_get_limit=Module._get_limit=function(){return Module.asm._get_limit.apply(null,arguments)},_get_conv_outMapSize=Module._get_conv_outMapSize=function(){return Module.asm._get_conv_outMapSize.apply(null,arguments)},___errno_location=Module.___errno_location=function(){return Module.asm.___errno_location.apply(null,arguments)},_set_conv_channels=Module._set_conv_channels=function(){return Module.asm._set_conv_channels.apply(null,arguments)},_set_neuron_derivative=Module._set_neuron_derivative=function(){return Module.asm._set_neuron_derivative.apply(null,arguments)},_get_conv_inMapValuesCount=Module._get_conv_inMapValuesCount=function(){return Module.asm._get_conv_inMapValuesCount.apply(null,arguments)},_set_stdDeviation=Module._set_stdDeviation=function(){return Module.asm._set_stdDeviation.apply(null,arguments)},_resetDeltaWeights=Module._resetDeltaWeights=function(){return Module.asm._resetDeltaWeights.apply(null,arguments)},_get_neuron_m=Module._get_neuron_m=function(){return Module.asm._get_neuron_m.apply(null,arguments)},_memmove=Module._memmove=function(){return Module.asm._memmove.apply(null,arguments)},_get_pool_stride=Module._get_pool_stride=function(){return Module.asm._get_pool_stride.apply(null,arguments)},_forward=Module._forward=function(){return Module.asm._forward.apply(null,arguments)},_malloc=Module._malloc=function(){return Module.asm._malloc.apply(null,arguments)},_set_updateFn=Module._set_updateFn=function(){return Module.asm._set_updateFn.apply(null,arguments)},_get_neuron_v=Module._get_neuron_v=function(){return Module.asm._get_neuron_v.apply(null,arguments)},_set_pool_indeces=Module._set_pool_indeces=function(){return Module.asm._set_pool_indeces.apply(null,arguments)},_set_filter_adadeltaWeightsCache=Module._set_filter_adadeltaWeightsCache=function(){return Module.asm._set_filter_adadeltaWeightsCache.apply(null,arguments)},dynCall_iiii=Module.dynCall_iiii=function(){return Module.asm.dynCall_iiii.apply(null,arguments)},dynCall_dii=Module.dynCall_dii=function(){return Module.asm.dynCall_dii.apply(null,arguments)},dynCall_viiiii=Module.dynCall_viiiii=function(){return Module.asm.dynCall_viiiii.apply(null,arguments)},dynCall_vi=Module.dynCall_vi=function(){return Module.asm.dynCall_vi.apply(null,arguments)},dynCall_vii=Module.dynCall_vii=function(){return Module.asm.dynCall_vii.apply(null,arguments)},dynCall_ii=Module.dynCall_ii=function(){return Module.asm.dynCall_ii.apply(null,arguments)},dynCall_v=Module.dynCall_v=function(){return Module.asm.dynCall_v.apply(null,arguments)},dynCall_viiiiii=Module.dynCall_viiiiii=function(){return Module.asm.dynCall_viiiiii.apply(null,arguments)},dynCall_ddii=Module.dynCall_ddii=function(){return Module.asm.dynCall_ddii.apply(null,arguments)},dynCall_viiii=Module.dynCall_viiii=function(){return Module.asm.dynCall_viiii.apply(null,arguments)},initialStackTop;if(Runtime.stackAlloc=Module.stackAlloc,Runtime.stackSave=Module.stackSave,Runtime.stackRestore=Module.stackRestore,Runtime.establishStackSpace=Module.establishStackSpace,Runtime.setTempRet0=Module.setTempRet0,Runtime.getTempRet0=Module.getTempRet0,Module.asm=asm,memoryInitializer)if("function"==typeof Module.locateFile?memoryInitializer=Module.locateFile(memoryInitializer):Module.memoryInitializerPrefixURL&&(memoryInitializer=Module.memoryInitializerPrefixURL+memoryInitializer),ENVIRONMENT_IS_NODE||ENVIRONMENT_IS_SHELL){var data=Module.readBinary(memoryInitializer);HEAPU8.set(data,Runtime.GLOBAL_BASE)}else{addRunDependency("memory initializer");var applyMemoryInitializer=function(e){e.byteLength&&(e=new Uint8Array(e)),HEAPU8.set(e,Runtime.GLOBAL_BASE),Module.memoryInitializerRequest&&delete Module.memoryInitializerRequest.response,removeRunDependency("memory initializer")};function doBrowserLoad(){Module.readAsync(memoryInitializer,applyMemoryInitializer,function(){throw"could not load memory initializer "+memoryInitializer})}if(Module.memoryInitializerRequest){function useRequest(){var e=Module.memoryInitializerRequest;if(200!==e.status&&0!==e.status)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+e.status+", retrying "+memoryInitializer),void doBrowserLoad();applyMemoryInitializer(e.response)}Module.memoryInitializerRequest.response?setTimeout(useRequest,0):Module.memoryInitializerRequest.addEventListener("load",useRequest)}else doBrowserLoad()}function ExitStatus(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}ExitStatus.prototype=new Error,ExitStatus.prototype.constructor=ExitStatus;var preloadStartTime=null,calledMain=!1;function run(e){function t(){Module.calledRun||(Module.calledRun=!0,ABORT||(ensureInitRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),Module._main&&shouldRunNow&&Module.callMain(e),postRun()))}e=e||Module.arguments,null===preloadStartTime&&(preloadStartTime=Date.now()),runDependencies>0||(preRun(),runDependencies>0||Module.calledRun||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),t()},1)):t()))}function exit(e,t){t&&Module.noExitRuntime||(Module.noExitRuntime||(ABORT=!0,EXITSTATUS=e,STACKTOP=initialStackTop,exitRuntime(),Module.onExit&&Module.onExit(e)),ENVIRONMENT_IS_NODE&&process.exit(e),Module.quit(e,new ExitStatus(e)))}dependenciesFulfilled=function e(){Module.calledRun||run(),Module.calledRun||(dependenciesFulfilled=e)},Module.callMain=Module.callMain=function(e){e=e||[],ensureInitRuntime();var t=e.length+1;function n(){for(var e=0;e<3;e++)i.push(0)}var i=[allocate(intArrayFromString(Module.thisProgram),"i8",ALLOC_NORMAL)];n();for(var r=0;r<t-1;r+=1)i.push(allocate(intArrayFromString(e[r]),"i8",ALLOC_NORMAL)),n();i.push(0),i=allocate(i,"i32",ALLOC_NORMAL);try{exit(Module._main(t,i,0),!0)}catch(e){if(e instanceof ExitStatus)return;if("SimulateInfiniteLoop"==e)return void(Module.noExitRuntime=!0);var a=e;e&&"object"==typeof e&&e.stack&&(a=[e,e.stack]),Module.printErr("exception thrown: "+a),Module.quit(1,e)}finally{calledMain=!0}},Module.run=Module.run=run,Module.exit=Module.exit=exit;var abortDecorators=[];function abort(e){Module.onAbort&&Module.onAbort(e),void 0!==e?(Module.print(e),Module.printErr(e),e=JSON.stringify(e)):e="",ABORT=!0,EXITSTATUS=1;var t="abort("+e+") at "+stackTrace()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";throw abortDecorators&&abortDecorators.forEach(function(n){t=n(t,e)}),t}if(Module.abort=Module.abort=abort,Module.preInit)for("function"==typeof Module.preInit&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();var shouldRunNow=!0;Module.noInitialRun&&(shouldRunNow=!1),Module.noExitRuntime=!0,run(),"undefined"!=typeof window&&(window.Module=Module)}).call(this,__webpack_require__(0),__webpack_require__(2))},function(e,t,n){"use strict";(function(e){class n{constructor(e,{filterSize:t,zeroPadding:n,stride:i,activation:r}={}){if(this.size=e,this.stride=i,this.filterSize=t,this.layerIndex=0,this.zeroPadding=n,this.activation=!1,this.activationName=r,void 0!=r){if("boolean"!=typeof r||r||(r="noactivation"),"string"!=typeof r)throw new Error("Custom activation functions are not available in the WebAssembly version");this.activationName=s.format(r)}}assignNext(e){this.nextLayer=e}assignPrev(e,t){this.netInstance=this.net.netInstance,this.prevLayer=e,this.layerIndex=t;const a=this.stride||this.net.conv.stride||1,o=this.filterSize||this.net.conv.filterSize||3;let l,u=this.zeroPadding;switch(s.defineProperty(this,"channels",["number","number"],[this.netInstance,t],{pre:"conv_"}),s.defineProperty(this,"filterSize",["number","number"],[this.netInstance,t],{pre:"conv_"}),s.defineProperty(this,"stride",["number","number"],[this.netInstance,t],{pre:"conv_"}),s.defineProperty(this,"zeroPadding",["number","number"],[this.netInstance,t],{pre:"conv_"}),this.size=this.size||4,!0){case e instanceof i:l=this.net.channels||1;break;case e instanceof n:l=e.size;break;case e instanceof h:l=e.activations.length}void 0==u&&(u=void 0==this.net.conv.zeroPadding?Math.floor(o/2):this.net.conv.zeroPadding),this.channels=l,this.filterSize=o,this.stride=a,this.zeroPadding=u;const c=e instanceof i?Math.max(Math.floor(Math.sqrt(e.size/l)),1):e.outMapSize;s.defineProperty(this,"inMapValuesCount",["number","number"],[this.netInstance,t],{pre:"conv_"}),s.defineProperty(this,"inZPMapValuesCount",["number","number"],[this.netInstance,t],{pre:"conv_"}),s.defineProperty(this,"outMapSize",["number","number"],[this.netInstance,t],{pre:"conv_"});const d=(c-o+2*u)/a+1;if(this.inMapValuesCount=Math.pow(c,2),this.inZPMapValuesCount=Math.pow(c+2*u,2),this.outMapSize=d,d%1!=0)throw new Error(`Misconfigured hyperparameters. Activation volume dimensions would be ${d} in conv layer at index ${t}`);!1!==this.activationName&&!1!==this.net.activationName&&(s.defineProperty(this,"activation",["number","number"],[this.netInstance,t],{pre:"conv_",getCallback:e=>`WASM ${this.activationName||this.net.activationName}`}),this.activation=s.activationsIndeces[this.activationName||this.net.activationName]),this.filters=[...new Array(this.size)].map(e=>new r)}init(){this.filters.forEach((e,t)=>{const n=["number","number","number"],i=[this.netInstance,this.layerIndex,t];s.defineMapProperty(e,"activationMap",n,i,this.outMapSize,this.outMapSize,{pre:"filter_"}),s.defineMapProperty(e,"errorMap",n,i,this.outMapSize,this.outMapSize,{pre:"filter_"}),s.defineMapProperty(e,"sumMap",n,i,this.outMapSize,this.outMapSize,{pre:"filter_"}),s.defineMapProperty(e,"dropoutMap",n,i,this.outMapSize,this.outMapSize,{pre:"filter_",getCallback:e=>e.map(e=>e.map(e=>1==e))}),e.init(this.netInstance,this.layerIndex,t,{updateFn:this.net.updateFn,filterSize:this.filterSize,channels:this.channels})})}toJSON(){return{weights:this.filters.map(e=>({bias:e.bias,weights:e.weights}))}}fromJSON(e,t){this.filters.forEach((n,i)=>{if(e.weights[i].weights.length!=n.weights.length)throw new Error(`Mismatched weights depth. Given: ${e.weights[i].weights.length} Existing: ${n.weights.length}. At: layers[${t}], filters[${i}]`);if(e.weights[i].weights[0].length!=n.weights[0].length)throw new Error(`Mismatched weights size. Given: ${e.weights[i].weights[0].length} Existing: ${n.weights[0].length}. At: layers[${t}], filters[${i}]`);n.bias=e.weights[i].bias,n.weights=e.weights[i].weights})}getDataSize(){let e=0;for(let t=0;t<this.filters.length;t++){const n=this.filters[t];for(let t=0;t<n.weights.length;t++)for(let i=0;i<n.weights[t].length;i++)e+=n.weights[t][i].length;e+=1}return e}toIMG(){const e=[];for(let t=0;t<this.filters.length;t++){const n=this.filters[t];e.push(n.bias);for(let t=0;t<n.weights.length;t++)for(let i=0;i<n.weights[t].length;i++)for(let r=0;r<n.weights[t][i].length;r++)e.push(n.weights[t][i][r])}return e}fromIMG(e){let t=0;for(let n=0;n<this.filters.length;n++){const i=this.filters[n];i.bias=e[t],t++;let r=i.weights.slice(0);for(let n=0;n<i.weights.length;n++)for(let a=0;a<i.weights[n].length;a++)for(let o=0;o<i.weights[n][a].length;o++)r[n][a][o]=e[t],t++;i.weights=r}}}"undefined"!=typeof window&&(window.exports=window.exports||{},window.global=window.global||{},window.global.jsNetWASMPath="./NetWASM.wasm",window.ConvLayer=n),t.ConvLayer=n;class i{constructor(e,{activation:t}={}){if(this.size=e,this.neurons=[...new Array(e)].map(e=>new u),this.layerIndex=0,void 0!=t){if("boolean"!=typeof t||t||(t="noactivation"),"string"!=typeof t)throw new Error("Custom activation functions are not available in the WebAssembly version");this.activationName=s.format(t)}}assignNext(e){this.nextLayer=e}assignPrev(e,t){this.netInstance=this.net.netInstance,this.prevLayer=e,this.layerIndex=t,(this.activationName||this.net.activationName)&&(s.defineProperty(this,"activation",["number","number"],[this.netInstance,t],{pre:"fc_",getCallback:e=>`WASM ${this.activationName||this.net.activationName}`}),this.activation=s.activationsIndeces[this.activationName||this.net.activationName])}init(){this.neurons.forEach((e,t)=>{switch(!0){case this.prevLayer instanceof i:e.size=this.prevLayer.size;break;case this.prevLayer instanceof n:e.size=this.prevLayer.filters.length*this.prevLayer.outMapSize**2;break;case this.prevLayer instanceof h:e.size=this.prevLayer.channels*this.prevLayer.outMapSize**2}e.init(this.netInstance,this.layerIndex,t,{updateFn:this.net.updateFn})})}toJSON(){return{weights:this.neurons.map(e=>({bias:e.bias,weights:e.weights}))}}fromJSON(e,t){this.neurons.forEach((n,i)=>{if(e.weights[i].weights.length!=n.weights.length)throw new Error(`Mismatched weights count. Given: ${e.weights[i].weights.length} Existing: ${n.weights.length}. At layers[${t}], neurons[${i}]`);n.bias=e.weights[i].bias,n.weights=e.weights[i].weights})}getDataSize(){let e=0;for(let t=0;t<this.neurons.length;t++)e+=this.neurons[t].weights.length+1;return e}toIMG(){const e=[];for(let t=0;t<this.neurons.length;t++){e.push(this.neurons[t].bias);for(let n=0;n<this.neurons[t].weights.length;n++)e.push(this.neurons[t].weights[n])}return e}fromIMG(e){let t=0;for(let n=0;n<this.neurons.length;n++){const i=this.neurons[n];i.bias=e[t],t++,i.weights=e.slice(t,t+i.weights.length),t+=i.weights.length}}}"undefined"!=typeof window&&(window.FCLayer=window.Layer=i),t.FCLayer=t.Layer=i;class r{constructor(){}init(e,t,n,{updateFn:i,channels:r,filterSize:a}){const o=["number","number","number"],l=[e,t,n];switch(s.defineProperty(this,"bias",o,l,{pre:"filter_"}),s.defineVolumeProperty(this,"weights",o,l,r,a,a,{pre:"filter_"}),s.defineProperty(this,"deltaBias",o,l,{pre:"filter_"}),s.defineVolumeProperty(this,"deltaWeights",o,l,r,a,a,{pre:"filter_"}),i){case"gain":s.defineProperty(this,"biasGain",o,l,{pre:"filter_"}),s.defineVolumeProperty(this,"weightGain",o,l,r,a,a,{pre:"filter_"});break;case"adagrad":case"rmsprop":case"adadelta":s.defineProperty(this,"biasCache",o,l,{pre:"filter_"}),s.defineVolumeProperty(this,"weightsCache",o,l,r,a,a,{pre:"filter_"}),"adadelta"==i&&(s.defineProperty(this,"adadeltaBiasCache",o,l,{pre:"filter_"}),s.defineVolumeProperty(this,"adadeltaWeightsCache",o,l,r,a,a,{pre:"filter_"}));break;case"adam":s.defineProperty(this,"m",o,l,{pre:"filter_"}),s.defineProperty(this,"v",o,l,{pre:"filter_"})}}}"undefined"!=typeof window&&(window.Filter=r),t.Filter=r;class a extends i{constructor(e,{span:t=1}={}){super(e*t*t)}}"undefined"!=typeof window&&(window.InputLayer=a),t.InputLayer=a;class o{static softmax(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];for(let n=0;n<e.length;n++)t&&(e[n]/=t);return e}}"undefined"!=typeof window&&(window.NetMath=o),t.NetMath=o;class s{static ccallArrays(e,t,n,i,{heapIn:r="HEAPF32",heapOut:a="HEAPF32",returnArraySize:o=1}={}){const l={};let u,h;l.HEAP8=Int8Array,l.HEAPU8=Uint8Array,l.HEAP16=Int16Array,l.HEAPU16=Uint16Array,l.HEAP32=Int32Array,l.HEAPU32=Uint32Array,l.HEAPF32=Float32Array,l.HEAPF64=Float64Array,n=n||[];const c="array"==t?"number":t,d=[],_=[],p=[];try{if(i)for(let e=0;e<i.length;e++)if("array"==n[e]||Array.isArray(i[e])){const t=new l[r](i[e]),n=s.Module._malloc(t.length*t.BYTES_PER_ELEMENT);switch(r){case"HEAP8":case"HEAPU8":s.Module[r].set(t,n);break;case"HEAP16":case"HEAPU16":s.Module[r].set(t,n>>1);break;case"HEAP32":case"HEAPU32":case"HEAPF32":s.Module[r].set(t,n>>2);break;case"HEAPF64":s.Module[r].set(t,n>>3)}p.push(n),d.push(n),d.push(i[e].length),_.push("number"),_.push("number")}else d.push(i[e]),_.push(void 0==n[e]?"number":n[e]);u=s.Module.ccall(e,c,_,d)}catch(e){h=e}finally{for(let e=0;e<p.length;e++)s.Module._free(p[e])}if(h)throw h;if("array"==t){const e=[];let t=0;for("auto"===o&&(t++,o=s.Module[a][u/l[a].BYTES_PER_ELEMENT]+1);t<o;t++)e.push(s.Module[a][u/l[a].BYTES_PER_ELEMENT+t]);return e}return u}static ccallVolume(e,t,n=[],i=[],{heapIn:r="HEAPF32",heapOut:a="HEAPF32",depth:o=1,rows:l=1,columns:u=l}={}){const h=o*l*u,c=[],d=[];for(let e=0;e<i.length;e++){let t=i[e];const r=Array.isArray(t)&&Array.isArray(t[0])&&Array.isArray(t[0][0]);if("volume"==n[e]||r){const e=[];for(let n=0;n<t.length;n++)for(let i=0;i<t[n].length;i++)for(let r=0;r<t[n][i].length;r++)e.push(t[n][i][r]);c.splice(c.length,0,e,t.length,t[0].length,t[0][0].length),d.splice(d.length,0,"array","number","number","number")}else c.push(t),d.push(n[e])}const _=s.ccallArrays(e,"volume"==t?"array":t,d,c,{heapIn:r,heapOut:a,returnArraySize:h}),p=[];if("volume"==t){for(let e=0;e<o;e++){const t=[];for(let n=0;n<l;n++){const i=[];for(let t=0;t<u;t++)i.push(_[e*l*u+n*u+t]);t.push(i)}p.push(t)}return p}return _}static format(e,t="string"){switch(!0){case"string"==t&&"string"==typeof e:e=e.replace(/(_|\s)/g,"").toLowerCase();break;case"time"==t&&"number"==typeof e:const n=new Date(e),i=[];e<1e3?i.push(`${n.getMilliseconds()}ms`):e<6e4?i.push(`${n.getSeconds()}.${n.getMilliseconds()}s`):(e>=36e5&&i.push(`${n.getHours()}h`),i.push(`${n.getMinutes()}m`),i.push(`${n.getSeconds()}s`)),e=i.join(" ")}return e}static shuffle(e){for(let t=e.length;t;t--){const n=Math.floor(Math.random()*t),i=e[t-1];e[t-1]=e[n],e[n]=i}}static splitData(e,{training:t=.7,validation:n=.15,test:i=.15}={}){const r={training:[],validation:[],test:[]};for(let i=0;i<e.length;i++){let a=Math.random();a>1-t?r.training.push(e[i]):a<n?r.validation.push(e[i]):r.test.push(e[i])}return r}static normalize(e){let t=1/0,n=-1/0;for(let i=0;i<e.length;i++)e[i]<t&&(t=e[i]),e[i]>n&&(n=e[i]);if(-1*t+n!=0)for(let i=0;i<e.length;i++)e[i]=(e[i]+-1*t)/(-1*t+n);else for(let t=0;t<e.length;t++)e[t]=.5;return{minVal:t,maxVal:n}}static defineProperty(e,t,n=[],i=[],{getCallback:r=(e=>e),setCallback:a=(e=>e),pre:o=""}={}){Object.defineProperty(e,t,{get:()=>r(this.Module.ccall(`get_${o}${t}`,"number",n,i)),set:e=>this.Module.ccall(`set_${o}${t}`,null,n.concat("number"),i.concat(a(e)))})}static defineArrayProperty(e,t,n,i,r,{pre:a=""}={}){Object.defineProperty(e,t,{get:()=>s.ccallArrays(`get_${a}${t}`,"array",n,i,{returnArraySize:r,heapOut:"HEAPF64"}),set:e=>s.ccallArrays(`set_${a}${t}`,null,n.concat("array"),i.concat([e]),{heapIn:"HEAPF64"})})}static defineMapProperty(e,t,n,i,r,a,{getCallback:o=(e=>e),setCallback:l=(e=>e),pre:u=""}={}){Object.defineProperty(e,t,{get:()=>o(s.ccallVolume(`get_${u}${t}`,"volume",n,i,{depth:1,rows:r,columns:a,heapOut:"HEAPF64"})[0]),set:e=>s.ccallVolume(`set_${u}${t}`,null,n.concat("array"),i.concat([l(e)]),{heapIn:"HEAPF64"})})}static defineVolumeProperty(e,t,n,i,r,a,o,{getCallback:l=(e=>e),setCallback:u=(e=>e),pre:h=""}={}){Object.defineProperty(e,t,{get:()=>l(s.ccallVolume(`get_${h}${t}`,"volume",n,i,{depth:r,rows:a,columns:o,heapOut:"HEAPF64"})),set:e=>s.ccallVolume(`set_${h}${t}`,null,n.concat("array"),i.concat([u(e)]),{heapIn:"HEAPF64"})})}static makeConfusionMatrix(e){let t=0,n=0;const i=[];for(let t=0;t<e.length;t++){const n=[];for(let i=0;i<e[t].length;i++)n.push(e[t][i]);i.push(n)}for(let e=0;e<i.length;e++)for(let n=0;n<i[e].length;n++)t+=i[e][n];for(let e=0;e<i.length;e++){let r=0;n+=i[e][e];for(let n=0;n<i[e].length;n++)r+=i[e][n],i[e][n]={count:i[e][n],percent:i[e][n]/t*100||0};const a=i[e][e].count/r*100;i[e].total={correct:a||0,wrong:100-a||0}}const r=[];for(let e=0;e<i[0].length;e++){let t=0;for(let n=0;n<i.length;n++)t+=i[n][e].count;const n=i[e][e].count/t*100;r.push({correct:n||0,wrong:100-n||0})}return i.total=r,i.total.total={correct:n/t*100||0,wrong:100-n/t*100||0},i}static printConfusionMatrix(t){if("undefined"!=typeof window){for(let e=0;e<t.length;e++){for(let n=0;n<t[e].length;n++)t[e][n]=`${t[e][n].count} (${t[e][n].percent.toFixed(1)}%)`;t[e].total=`${t[e].total.correct.toFixed(1)}% / ${t[e].total.wrong.toFixed(1)}%`,t.total[e]=`${t.total[e].correct.toFixed(1)}% / ${t.total[e].wrong.toFixed(1)}%`}return t.total.total=`${t.total.total.correct.toFixed(1)}% / ${t.total.total.wrong.toFixed(1)}%`,void console.table(t)}const n=(e,t)=>{e=t?e.toFixed(1)+"%":e.toString();const n=Math.max(Math.floor((7-e.length)/2),0),i=Math.max(7-(e.length+n),0);return" ".repeat(n)+e+" ".repeat(i)};let i,r;e.stdout.write("\n[1m");for(let a=0;a<t.length;a++){i="[2m[37m";for(let o=0;o<t[a].length;o++)r=a==o?"[42m":"[41m",e.stdout.write(`${i}${r}[1m${n(t[a][o].count)}[22m`);i="[2m[32m",r="[47m",e.stdout.write(`${i}${r}${n(t[a].total.correct,!0)}`),i="[2m[37m",e.stdout.write(`${i}\n`);for(let o=0;o<t[a].length;o++)r=a==o?"[42m":"[41m",e.stdout.write(`${i}${r}${n(t[a][o].percent,!0)}`);i="[2m[31m",r="[47m",e.stdout.write(`${i}${r}${n(t[a].total.wrong,!0)}`),e.stdout.write("[1m[30m\n")}i="[22m[32m";for(const a of t.total)e.stdout.write(`${i}${r}${n(a.correct,!0)}`);r="[1m[44m",e.stdout.write(`${i}${r}${n(t.total.total.correct,!0)}\n`),i="[22m[31m",r="[47m";for(const a of t.total)e.stdout.write(`${i}${r}${n(a.wrong,!0)}`);i="[1m[31m",r="[44m",e.stdout.write(`${i}${r}${n(t.total.total.wrong,!0)}\n`),e.stdout.write("[0m\n")}}s.activationsIndeces={noactivation:-1,sigmoid:0,tanh:1,lecuntanh:2,relu:3,lrelu:4,rrelu:5,elu:6},"undefined"!=typeof window&&(window.NetUtil=s),t.NetUtil=s;class l{constructor({Module:e,learningRate:t,activation:r="sigmoid",updateFn:a="vanillasgd",cost:o="meansquarederror",layers:l=[],momentum:u=.9,rmsDecay:c,rho:d,lreluSlope:_,eluAlpha:p,dropout:f=1,l2:g,l1:m,maxNorm:M,weightsConfig:y,channels:v,conv:E,pool:w}){if(!e)throw new Error("WASM module not provided");if("function"==typeof r||"function"==typeof o)throw new Error("Custom functions are not (yet) supported with WASM.");s.Module=e,this.Module=e,this.conv={},this.pool={},this.netInstance=this.Module.ccall("newNetwork",null,null,null),this.state="not-defined",Object.defineProperty(this,"learningRate",{get:this.Module.cwrap("getLearningRate",null,null).bind(this,this.netInstance),set:this.Module.cwrap("setLearningRate","number",null).bind(this,this.netInstance)}),t&&(this.learningRate=t),s.defineProperty(this,"dropout",["number"],[this.netInstance]),this.dropout=0==f?1:f,g&&(s.defineProperty(this,"l2",["number"],[this.netInstance]),s.defineProperty(this,"l2Error",["number"],[this.netInstance]),this.l2="boolean"==typeof g?.001:g),m&&(s.defineProperty(this,"l1",["number"],[this.netInstance]),s.defineProperty(this,"l1Error",["number"],[this.netInstance]),this.l1="boolean"==typeof m?.005:m),M&&(s.defineProperty(this,"maxNorm",["number"],[this.netInstance]),s.defineProperty(this,"maxNormTotal",["number"],[this.netInstance]),this.maxNorm="boolean"==typeof M&&M?1e3:M),v&&(s.defineProperty(this,"channels",["number"],[this.netInstance]),this.channels=v),E&&(void 0!=E.filterSize&&(this.conv.filterSize=E.filterSize),void 0!=E.zeroPadding&&(this.conv.zeroPadding=E.zeroPadding),void 0!=E.stride&&(this.conv.stride=E.stride)),w&&(w.size&&(this.pool.size=w.size),w.stride&&(this.pool.stride=w.stride)),Object.defineProperty(this,"error",{get:()=>e.ccall("getError","number",["number"],[this.netInstance])}),Object.defineProperty(this,"validationError",{get:()=>e.ccall("getValidationError","number",["number"],[this.netInstance])}),Object.defineProperty(this,"lastValidationError",{get:()=>e.ccall("getLastValidationError","number",["number"],[this.netInstance])}),this.activationName=s.format(r),Object.defineProperty(this,"activation",{get:()=>`WASM ${this.activationName}`,set:e=>{if(void 0==s.activationsIndeces[e])throw new Error(`The ${e} activation function does not exist`);this.activationName=e,this.Module.ccall("setActivation",null,["number","number"],[this.netInstance,s.activationsIndeces[e]])}}),this.activation=this.activationName;const S={meansquarederror:0,crossentropy:1};let b=s.format(o);Object.defineProperty(this,"cost",{get:()=>`WASM ${b}`,set:e=>{if(void 0==S[e])throw new Error(`The ${e} function does not exist`);b=e,this.Module.ccall("setCostFunction",null,["number","number"],[this.netInstance,S[e]])}}),this.cost=b;const A={vanillasgd:0,gain:1,adagrad:2,rmsprop:3,adam:4,adadelta:5,momentum:6};s.defineProperty(this,"updateFn",["number"],[this.netInstance],{getCallback:e=>Object.keys(A).find(t=>A[t]==e),setCallback:e=>A[e]}),this.updateFn=s.format(a);const T={uniform:0,gaussian:1,xavieruniform:2,xaviernormal:3,lecununiform:4,lecunnormal:5};if(this.weightsConfig={},s.defineProperty(this.weightsConfig,"distribution",["number"],[this.netInstance],{getCallback:e=>Object.keys(T).find(t=>T[t]==Math.round(e)),setCallback:e=>T[e]}),s.defineProperty(this.weightsConfig,"limit",["number"],[this.netInstance]),s.defineProperty(this.weightsConfig,"mean",["number"],[this.netInstance]),s.defineProperty(this.weightsConfig,"stdDeviation",["number"],[this.netInstance]),this.weightsConfig.distribution="xavieruniform",void 0!=y&&y.distribution){if("function"==typeof y.distribution)throw new Error("Custom weights init functions are not (yet) supported with WASM.");this.weightsConfig.distribution=s.format(y.distribution)}switch(this.weightsConfig.limit=y&&void 0!=y.limit?y.limit:.1,this.weightsConfig.mean=y&&void 0!=y.mean?y.mean:0,this.weightsConfig.stdDeviation=y&&void 0!=y.stdDeviation?y.stdDeviation:.05,s.format(a)){case"rmsprop":this.learningRate=void 0==this.learningRate?.001:this.learningRate;break;case"adam":this.learningRate=void 0==this.learningRate?.01:this.learningRate;break;case"adadelta":s.defineProperty(this,"rho",["number"],[this.netInstance]),this.rho=null==d?.95:d;break;case"momentum":s.defineProperty(this,"momentum",["number"],[this.netInstance]),this.momentum=u;break;default:if(void 0==t)switch(this.activationName){case"relu":case"lrelu":case"rrelu":case"elu":this.learningRate=.01;break;case"tanh":case"lecuntanh":this.learningRate=.001;break;default:this.learningRate=.2}}if("rmsprop"==this.updateFn&&(s.defineProperty(this,"rmsDecay",["number"],[this.netInstance]),this.rmsDecay=void 0===c?.99:c),"lrelu"==this.activationName?(s.defineProperty(this,"lreluSlope",["number"],[this.netInstance]),this.lreluSlope=void 0==_?-5e-4:_):"elu"==this.activationName&&(s.defineProperty(this,"eluAlpha",["number"],[this.netInstance]),this.eluAlpha=void 0==p?1:p),this.layers=[],this.epochs=0,s.defineProperty(this,"iterations",["number"],[this.netInstance]),s.defineProperty(this,"validations",["number"],[this.netInstance]),s.defineProperty(this,"validationInterval",["number"],[this.netInstance]),s.defineProperty(this,"trainingLogging",["number"],[this.netInstance]),s.defineProperty(this,"stoppedEarly",["number"],[this.netInstance]),s.defineProperty(this,"earlyStoppingType",["number"],[this.netInstance]),s.defineProperty(this,"earlyStoppingThreshold",["number"],[this.netInstance]),s.defineProperty(this,"earlyStoppingBestError",["number"],[this.netInstance]),s.defineProperty(this,"earlyStoppingPatienceCounter",["number"],[this.netInstance]),s.defineProperty(this,"earlyStoppingPatience",["number"],[this.netInstance]),s.defineProperty(this,"earlyStoppingPercent",["number"],[this.netInstance]),this.collectedErrors={},s.defineArrayProperty(this.collectedErrors,"training",["number"],[this.netInstance],"auto",{pre:"collected_"}),s.defineArrayProperty(this.collectedErrors,"test",["number"],[this.netInstance],"auto",{pre:"collected_"}),s.defineArrayProperty(this.collectedErrors,"validation",["number"],[this.netInstance],"auto",{pre:"collected_"}),l.length)switch(this.state="constructed",!0){case l.every(e=>Number.isInteger(e)):this.layers=l.map(e=>new i(e)),this.initLayers();break;case l.every(e=>e instanceof i||e instanceof n||e instanceof h):this.layers=l,this.initLayers();break;default:throw new Error("There was an error constructing from the layers given.")}}initLayers(e,t){if("initialised"==this.state)return;"not-defined"==this.state&&(this.layers[0]=new i(e),this.layers[1]=new i(Math.ceil(e/t>5?t+Math.abs(e-t)/4:e+t)),this.layers[2]=new i(Math.ceil(t))),this.state="initialised";for(let e=0;e<this.layers.length;e++){const t=this.layers[e];switch(!0){case t instanceof i:this.Module.ccall("addFCLayer",null,["number","number"],[this.netInstance,t.size]);break;case t instanceof n:this.Module.ccall("addConvLayer",null,["number","number"],[this.netInstance,t.size]);break;case t instanceof h:this.Module.ccall("addPoolLayer",null,["number","number"],[this.netInstance,t.size])}this.joinLayer(t,e)}this.Module.ccall("initLayers",null,["number"],[this.netInstance]);const r=this.layers[this.layers.length-1].size,a=e=>e.map(e=>e.map(e=>Math.floor(e)));s.defineMapProperty(this,"trainingConfusionMatrix",["number"],[this.netInstance],r,r,{getCallback:a}),s.defineMapProperty(this,"testConfusionMatrix",["number"],[this.netInstance],r,r,{getCallback:a}),s.defineMapProperty(this,"validationConfusionMatrix",["number"],[this.netInstance],r,r,{getCallback:a})}joinLayer(e,t){e.net=this,e.layerIndex=t,t&&(this.layers[t-1].assignNext(e),e.assignPrev(this.layers[t-1],t)),e.init()}forward(e){if("initialised"!=this.state)throw new Error("The network layers have not been initialised.");if(void 0===e||null===e)throw new Error("No data passed to Network.forward()");if(Array.isArray(e[0])){const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[0].length;i++)for(let r=0;r<e[0].length;r++)t.push(e[n][i][r]);e=t}return e.length!=this.layers[0].neurons.length&&console.warn("Input data length did not match input layer neurons count."),s.ccallArrays("forward","array",["number","array"],[this.netInstance,e],{heapOut:"HEAPF64",returnArraySize:this.layers[this.layers.length-1].neurons.length})}train(e,{epochs:t=1,callback:n,callbackInterval:i=1,collectErrors:r,miniBatchSize:a=1,log:o=!0,shuffle:l=!1,validation:u}={}){return a="boolean"==typeof a&&a?e[0].expected.length:a,this.Module.ccall("set_miniBatchSize",null,["number","number"],[this.netInstance,a]),this.validation=u,this.trainingLogging=o,this.stoppedEarly=!1,new Promise((h,c)=>{if(void 0===e||null===e)return void c("No data provided");"initialised"!=this.state&&this.initLayers(e[0].input.length,e[0].expected.length);const d=Date.now(),_=this.layers[0].size,p=_+e[0].expected.length,f=p*e.length;o&&console.log(`Training started. Epochs: ${t} Batch size: ${a}`);const g=new Float32Array(f);this.loadData(e,g,p,c);const m=this.Module._malloc(g.length*g.BYTES_PER_ELEMENT);let M,y;if(this.Module.HEAPF32.set(g,m>>2),this.Module.ccall("loadTrainingData","number",["number","number","number","number","number"],[this.netInstance,m,f,p,_]),l&&this.Module.ccall("shuffleTrainingData",null,["number"],[this.netInstance]),r&&this.Module.ccall("collectErrors",null,["number"],[this.netInstance]),this.validation){if(this.validationInterval=this.validation.interval||e.length,this.validation.earlyStopping)switch(this.validation.earlyStopping.type){case"threshold":this.validation.earlyStopping.threshold=this.validation.earlyStopping.threshold||.01,this.earlyStoppingThreshold=this.validation.earlyStopping.threshold,this.earlyStoppingType=1;break;case"patience":this.validation.earlyStopping.patience=this.validation.earlyStopping.patience||20,this.earlyStoppingBestError=1/0,this.earlyStoppingPatienceCounter=0,this.earlyStoppingPatience=this.validation.earlyStopping.patience,this.earlyStoppingType=2;break;case"divergence":this.validation.earlyStopping.percent=this.validation.earlyStopping.percent||30,this.earlyStoppingBestError=1/0,this.earlyStoppingPercent=this.validation.earlyStopping.percent,this.earlyStoppingType=3}if(this.validation.data){const e=new Float32Array(this.validation.data.length);this.loadData(this.validation.data,e,p,c),y=this.Module._malloc(e.length*e.BYTES_PER_ELEMENT),this.Module.HEAPF32.set(e,m>>2),this.Module.ccall("loadValidationData","number",["number","number","number","number","number"],[this.netInstance,m,f,p,_])}}const v=()=>{this.Module._free(m),this.Module._free(y),this.validation&&this.validation.earlyStopping&&("patience"==this.validation.earlyStopping.type||"divergence"==this.validation.earlyStopping.type)&&this.Module.ccall("restoreValidation",null,["number"],[this.netInstance]),o&&console.log(`Training finished. Total time: ${s.format(M,"time")}`),h()};if(n){let r=0,l=0;const u=()=>{this.l2&&(this.l2Error=0),this.l1&&(this.l1Error=0),l=0,h()},h=()=>{if(this.Module.ccall("train","number",["number","number","number"],[this.netInstance,a,l]),(l%i==0||this.validationError)&&n({iterations:this.iterations,validations:this.validations,trainingError:this.error,validationError:this.validationError,elapsed:Date.now()-d,input:e[l].input}),(l+=a)<e.length&&!this.stoppedEarly)l%i==0?setTimeout(h.bind(this),0):h();else{if(r++,M=Date.now()-d,o){let e=`Epoch: ${r}\nTraining Error: ${this.error}`;this.validation&&(e+=`\nValidation Error: ${this.lastValidationError}`),void 0!=this.l2Error&&(e+=`\nL2 Error: ${this.l2Error/l}`),e+=`\nElapsed: ${s.format(M,"time")} Average Duration: ${s.format(M/r,"time")}`,console.log(e)}r<t&&!this.stoppedEarly?u():v()}};u()}else{for(let n=0;n<t;n++){if(this.l2&&(this.l2Error=0),this.l1&&(this.l1Error=0),this.Module.ccall("train","number",["number","number","number"],[this.netInstance,-1,0]),M=Date.now()-d,o){let t=`Epoch: ${n+1}\nTraining Error: ${this.error}`;u&&(t+=`\nValidation Error: ${this.lastValidationError}`),void 0!=this.l2Error&&(t+=`\nL2 Error: ${this.l2Error/e.length}`),t+=`\nElapsed: ${s.format(M,"time")} Average Duration: ${s.format(M/(n+1),"time")}`,console.log(t)}if(this.stoppedEarly)break}v()}})}loadData(e,t,n,i){for(let r=0;r<e.length;r++){if(!e[r].hasOwnProperty("input")||!e[r].hasOwnProperty("expected"))return void i("Data set must be a list of objects with keys: 'input' and 'expected'");let a=n*r;if(Array.isArray(e[r].input[0]))for(let n=0;n<e[r].input.length;n++)for(let i=0;i<e[r].input[0].length;i++)for(let o=0;o<e[r].input[0].length;o++)t[a]=e[r].input[n][i][o],a++;else for(let n=0;n<e[r].input.length;n++)t[a]=e[r].input[n],a++;for(let n=0;n<e[r].expected.length;n++)t[a]=e[r].expected[n],a++}}test(e,{log:t=!0,collectErrors:n,callback:i}={}){return new Promise((r,a)=>{void 0!==e&&null!==e||a("No data provided"),t&&console.log("Testing started");const o=Date.now(),l=e[0].input.length,u=l+e[0].expected.length,h=u*e.length,c=new Float32Array(h);this.loadData(e,c,u,a);const d=this.Module._malloc(c.length*c.BYTES_PER_ELEMENT);if(this.Module.HEAPF32.set(c,d>>2),this.Module.ccall("loadTestingData","number",["number","number","number","number","number"],[this.netInstance,d,h,u,l]),n&&this.Module.ccall("collectErrors",null,["number"],[this.netInstance]),i){let n=0,a=0;const l=()=>{if(a+=this.Module.ccall("test","number",["number","number","number"],[this.netInstance,1,n]),i({iterations:n+1,error:a/(n+1),elapsed:Date.now()-o,input:e[n].input}),++n<e.length)setTimeout(l.bind(this),0);else{const i=Date.now()-o;t&&console.log(`Testing finished. Total time: ${s.format(i,"time")}  Average iteration time: ${s.format(i/n,"time")}`),this.Module._free(d),r(a/e.length)}};l()}else{const n=this.Module.ccall("test","number",["number","number"],[this.netInstance,-1,0]);this.Module._free(d);const i=Date.now()-o;t&&console.log(`Testing finished. Total time: ${s.format(i,"time")}  Average iteration time: ${s.format(i/e.length,"time")}`),r(n)}})}toJSON(){return{layers:this.layers.map(e=>e.toJSON())}}fromJSON(e){if(void 0===e||null===e)throw new Error("No JSON data given to import.");if(e.layers.length!=this.layers.length)throw new Error(`Mismatched layers (${e.layers.length} layers in import data, but ${this.layers.length} configured)`);this.Module.ccall("resetDeltaWeights",null,["number"],[this.netInstance]),this.layers.forEach((t,n)=>n&&t.fromJSON(e.layers[n],n))}toIMG(e,t={}){if(!e)throw new Error("The IMGArrays library must be provided. See the documentation for instructions.");const n=[];for(let e=1;e<this.layers.length;e++){const t=this.layers[e].toIMG();for(let e=0;e<t.length;e++)n.push(t[e])}return e.toIMG(n,t)}fromIMG(e,t,n={}){if(!t)throw new Error("The IMGArrays library must be provided. See the documentation for instructions.");const i=t.fromIMG(e,n);for(let e=1;e<this.layers.length;e++){const t=this.layers[e].getDataSize();this.layers[e].fromIMG(i.splice(0,t))}}printConfusionMatrix(e){if(e)s.printConfusionMatrix(s.makeConfusionMatrix(this[`${e}ConfusionMatrix`]));else{const e=[];for(let t=0;t<this.trainingConfusionMatrix.length;t++){const n=[];for(let e=0;e<this.trainingConfusionMatrix.length;e++)n.push(this.trainingConfusionMatrix[t][e]+this.testConfusionMatrix[t][e]+this.validationConfusionMatrix[t][e]);e.push(n)}s.printConfusionMatrix(s.makeConfusionMatrix(e))}}static get version(){return"3.3.0"}}"undefined"!=typeof window&&(window.Network=l),t.Network=l;class u{constructor(){}init(e,t,n,{updateFn:i}){const r=["number","number","number"],a=[e,t,n];switch(s.defineProperty(this,"sum",r,a,{pre:"neuron_"}),s.defineProperty(this,"dropped",r,a,{pre:"neuron_",getCallback:e=>1==e,setCallback:e=>e?1:0}),s.defineProperty(this,"activation",r,a,{pre:"neuron_"}),s.defineProperty(this,"error",r,a,{pre:"neuron_"}),s.defineProperty(this,"derivative",r,a,{pre:"neuron_"}),s.defineProperty(this,"bias",r,a,{pre:"neuron_"}),t&&s.defineArrayProperty(this,"weights",r,a,this.size,{pre:"neuron_"}),s.defineProperty(this,"deltaBias",r,a,{pre:"neuron_"}),s.defineArrayProperty(this,"deltaWeights",r,a,this.size,{pre:"neuron_"}),i){case"gain":s.defineProperty(this,"biasGain",r,a,{pre:"neuron_"}),s.defineArrayProperty(this,"weightGain",r,a,this.size,{pre:"neuron_"});break;case"adagrad":case"rmsprop":case"adadelta":s.defineProperty(this,"biasCache",r,a,{pre:"neuron_"}),s.defineArrayProperty(this,"weightsCache",r,a,this.size,{pre:"neuron_"}),"adadelta"==i&&(s.defineProperty(this,"adadeltaBiasCache",r,a,{pre:"neuron_"}),s.defineArrayProperty(this,"adadeltaCache",r,a,this.size,{pre:"neuron_"}));break;case"adam":s.defineProperty(this,"m",r,a,{pre:"neuron_"}),s.defineProperty(this,"v",r,a,{pre:"neuron_"})}}}"undefined"!=typeof window&&(window.Neuron=u),t.Neuron=u;class h{constructor(e,{stride:t,activation:n}={}){if(e&&(this.size=e),t&&(this.stride=t),this.activation=!1,this.activationName=n,void 0!=n){if("boolean"!=typeof n||n||(n="noactivation"),"string"!=typeof n)throw new Error("Custom activation functions are not available in the WebAssembly version");this.activationName=s.format(n)}}assignNext(e){this.nextLayer=e}assignPrev(e,t){this.netInstance=this.net.netInstance,this.prevLayer=e,this.layerIndex=t;let r,a=e.outMapSize;const o=this.size||this.net.pool.size||2,l=this.stride||this.net.pool.stride||this.size;switch(s.defineProperty(this,"channels",["number","number"],[this.netInstance,t],{pre:"pool_"}),s.defineProperty(this,"stride",["number","number"],[this.netInstance,t],{pre:"pool_"}),this.size=o,this.stride=l,!0){case e instanceof i:r=this.net.channels,a=Math.max(Math.floor(Math.sqrt(e.size/r)),1);break;case e instanceof n:r=e.size;break;case e instanceof h:r=e.channels}this.channels=r,s.defineProperty(this,"prevLayerOutWidth",["number","number"],[this.netInstance,t],{pre:"pool_"}),s.defineProperty(this,"inMapValuesCount",["number","number"],[this.netInstance,t],{pre:"pool_"}),s.defineProperty(this,"outMapSize",["number","number"],[this.netInstance,t],{pre:"pool_"}),s.defineVolumeProperty(this,"errors",["number","number"],[this.netInstance,t],r,a,a,{pre:"pool_"});const u=(a-o)/l+1;if(this.outMapSize=u,this.inMapValuesCount=a**2,s.defineVolumeProperty(this,"activations",["number","number"],[this.netInstance,t],r,u,u,{pre:"pool_"}),s.defineVolumeProperty(this,"indeces",["number","number"],[this.netInstance,t],r,u,u,{pre:"pool_",getCallback:e=>e.map(e=>e.map(e=>e.map(e=>[parseInt(e/2),e%2]))),setCallback:e=>e.map(e=>e.map(e=>e.map(([e,t])=>2*e+t)))}),u%1!=0)throw new Error(`Misconfigured hyperparameters. Activation volume dimensions would be ${u} in pool layer at index ${t}`);this.activationName&&(s.defineProperty(this,"activation",["number","number"],[this.netInstance,t],{pre:"pool_",getCallback:e=>`WASM ${this.activationName}`}),this.activation=s.activationsIndeces[this.activationName])}init(){}toJSON(){return{}}fromJSON(){}getDataSize(){return 0}toIMG(){return[]}fromIMG(){}}"undefined"!=typeof window&&(window.PoolLayer=h),t.PoolLayer=h}).call(this,n(0))},function(e,t,n){"use strict";(function(e){class n{constructor(e,{filterSize:t,zeroPadding:n,stride:i,activation:r}={}){t&&(this.filterSize=t),i&&(this.stride=i),e&&(this.size=e),this.zeroPadding=n,this.activationName=r,void 0!=r&&(this.activation=!("boolean"==typeof r&&!r)&&("function"==typeof r?r:o[s.format(r)].bind(this))),this.state="not-initialised"}assignNext(e){this.nextLayer=e}assignPrev(e,t){switch(this.prevLayer=e,this.layerIndex=t,this.size=this.size||4,this.filterSize=this.filterSize||this.net.conv.filterSize||3,this.stride=this.stride||this.net.conv.stride||1,!0){case e instanceof i:this.channels=this.net.channels||1;break;case e instanceof n:this.channels=e.size;break;case e instanceof h:this.channels=e.activations.length}void 0==this.zeroPadding&&(this.zeroPadding=void 0==this.net.conv.zeroPadding?Math.floor(this.filterSize/2):this.net.conv.zeroPadding);const a=e instanceof i?Math.max(Math.floor(Math.sqrt(e.size/this.channels)),1):e.outMapSize;if(this.inMapValuesCount=Math.pow(a,2),this.inZPMapValuesCount=Math.pow(a+2*this.zeroPadding,2),this.outMapSize=(a-this.filterSize+2*this.zeroPadding)/this.stride+1,this.outMapSize%1!=0)throw new Error(`Misconfigured hyperparameters. Activation volume dimensions would be ${this.outMapSize} in conv layer at index ${t}`);this.filters=[...new Array(this.size)].map(e=>new r)}init(){this.filters.forEach(e=>{e.weights=[...new Array(this.channels)].map(e=>[...new Array(this.filterSize)].map(e=>this.net.weightsInitFn(this.filterSize,this.weightsConfig))),e.activationMap=[...new Array(this.outMapSize)].map(e=>[...new Array(this.outMapSize)].map(e=>0)),e.errorMap=[...new Array(this.outMapSize)].map(e=>[...new Array(this.outMapSize)].map(e=>0)),e.bias=1,1!=this.net.dropout&&(e.dropoutMap=e.activationMap.map(e=>e.map(e=>!1))),e.init({updateFn:this.net.updateFn,activation:this.activationName||this.net.activationConfig,eluAlpha:this.net.eluAlpha})})}forward(){const e=s.getActivations(this.prevLayer);for(let t=0;t<this.size;t++){const n=this.filters[t];n.sumMap=s.convolve({input:e,zeroPadding:this.zeroPadding,weights:n.weights,channels:this.channels,stride:this.stride,bias:n.bias});for(let e=0;e<n.sumMap.length;e++)for(let t=0;t<n.sumMap.length;t++)"training"==this.state&&n.dropoutMap&&(n.dropoutMap[e][t]=Math.random()>this.net.dropout)?n.activationMap[e][t]=0:this.activation?n.activationMap[e][t]=this.activation(n.sumMap[e][t],!1,n)/(this.net.dropout||1):n.activationMap[e][t]=n.sumMap[e][t]}}backward(){if(this.nextLayer instanceof i)for(let e=0;e<this.filters.length;e++){const t=this.filters[e];for(let n=0;n<t.errorMap.length;n++)for(let i=0;i<t.errorMap.length;i++){const r=e*this.outMapSize**2+n*t.errorMap.length+i;for(let e=0;e<this.nextLayer.neurons.length;e++){const a=this.nextLayer.neurons[e];t.errorMap[n][i]+=a.error*a.weights[r]}}}else if(this.nextLayer instanceof n)for(let e=0;e<this.filters.length;e++)s.buildConvErrorMap(this.nextLayer,this.filters[e].errorMap,e);else for(let e=0;e<this.filters.length;e++){const t=this.filters[e];for(let n=0;n<t.errorMap.length;n++)for(let i=0;i<t.errorMap.length;i++)t.errorMap[n][i]=this.nextLayer.errors[e][n][i]}for(let e=0;e<this.filters.length;e++){const t=this.filters[e];for(let e=0;e<t.errorMap.length;e++)for(let n=0;n<t.errorMap[0].length;n++)t.dropoutMap&&t.dropoutMap[e][n]?t.errorMap[e][n]=0:this.activation&&(t.errorMap[e][n]*=this.activation(t.sumMap[e][n],!0,t))}s.buildConvDWeights(this)}resetDeltaWeights(){for(let e=0;e<this.filters.length;e++){const t=this.filters[e];t.deltaBias=0;for(let e=0;e<t.deltaWeights.length;e++)for(let n=0;n<t.deltaWeights[0].length;n++)for(let i=0;i<t.deltaWeights[0][0].length;i++)t.deltaWeights[e][n][i]=0;for(let e=0;e<t.errorMap.length;e++)for(let n=0;n<t.errorMap.length;n++)t.errorMap[e][n]=0;if(t.dropoutMap)for(let e=0;e<t.dropoutMap.length;e++)for(let n=0;n<t.dropoutMap[0].length;n++)t.dropoutMap[e][n]=!1}}applyDeltaWeights(){for(let e=0;e<this.filters.length;e++){const t=this.filters[e];for(let e=0;e<t.deltaWeights.length;e++)for(let n=0;n<t.deltaWeights[0].length;n++)for(let i=0;i<t.deltaWeights[0][0].length;i++){void 0!=this.net.l2Error&&(this.net.l2Error+=.5*this.net.l2*t.weights[e][n][i]**2),void 0!=this.net.l1Error&&(this.net.l1Error+=this.net.l1*Math.abs(t.weights[e][n][i]));const r=(t.deltaWeights[e][n][i]+this.net.l2*t.weights[e][n][i]+this.net.l1*(t.weights[e][n][i]>0?1:-1))/this.net.miniBatchSize;t.weights[e][n][i]=this.net.weightUpdateFn.bind(this.net,t.weights[e][n][i],r,t,[e,n,i])(),void 0!=this.net.maxNorm&&(this.net.maxNormTotal+=t.weights[e][n][i]**2)}t.bias=this.net.weightUpdateFn.bind(this.net,t.bias,t.deltaBias,t)()}}backUpValidation(){for(let e=0;e<this.filters.length;e++){const t=this.filters[e];t.validationBias=t.bias,t.validationWeights=[];for(let e=0;e<t.weights.length;e++){const n=[];for(let i=0;i<t.weights[e].length;i++)n[i]=t.weights[e][i].slice(0);t.validationWeights[e]=n}}}restoreValidation(){for(let e=0;e<this.filters.length;e++){const t=this.filters[e];t.bias=t.validationBias;for(let e=0;e<t.weights.length;e++)for(let n=0;n<t.weights[e].length;n++)t.weights[e][n]=t.validationWeights[e][n].slice(0)}}toJSON(){return{weights:this.filters.map(e=>({bias:e.bias,weights:e.weights}))}}fromJSON(e,t){this.filters.forEach((n,i)=>{if(e.weights[i].weights.length!=n.weights.length)throw new Error(`Mismatched weights depth. Given: ${e.weights[i].weights.length} Existing: ${n.weights.length}. At: layers[${t}], filters[${i}]`);if(e.weights[i].weights[0].length!=n.weights[0].length)throw new Error(`Mismatched weights size. Given: ${e.weights[i].weights[0].length} Existing: ${n.weights[0].length}. At: layers[${t}], filters[${i}]`);n.bias=e.weights[i].bias,n.weights=e.weights[i].weights})}getDataSize(){let e=0;for(let t=0;t<this.filters.length;t++){const n=this.filters[t];for(let t=0;t<n.weights.length;t++)for(let i=0;i<n.weights[t].length;i++)e+=n.weights[t][i].length;e+=1}return e}toIMG(){const e=[];for(let t=0;t<this.filters.length;t++){const n=this.filters[t];e.push(n.bias);for(let t=0;t<n.weights.length;t++)for(let i=0;i<n.weights[t].length;i++)for(let r=0;r<n.weights[t][i].length;r++)e.push(n.weights[t][i][r])}return e}fromIMG(e){let t=0;for(let n=0;n<this.filters.length;n++){const i=this.filters[n];i.bias=e[t],t++;for(let n=0;n<i.weights.length;n++)for(let r=0;r<i.weights[n].length;r++)for(let a=0;a<i.weights[n][r].length;a++)i.weights[n][r][a]=e[t],t++}}}"undefined"!=typeof window&&(window.exports=window.exports||{}),"undefined"!=typeof window&&(window.ConvLayer=n),t.ConvLayer=n;class i{constructor(e,{activation:t}={}){this.size=e,this.neurons=[...new Array(e)].map(e=>new u),this.state="not-initialised",void 0!=t&&(this.activation=!("boolean"==typeof t&&!t)&&("function"==typeof t?t:o[s.format(t)].bind(this)))}assignNext(e){this.nextLayer=e}assignPrev(e,t){this.prevLayer=e,this.layerIndex=t}init(){this.neurons.forEach(e=>{let t;switch(!0){case this.prevLayer instanceof i:t=this.prevLayer.size;break;case this.prevLayer instanceof n:t=this.prevLayer.filters.length*this.prevLayer.outMapSize**2;break;case this.prevLayer instanceof h:t=this.prevLayer.activations.length*this.prevLayer.outMapSize**2}e.weights=this.net.weightsInitFn(t,this.weightsConfig),e.bias=1,e.init({updateFn:this.net.updateFn,activationConfig:this.net.activationConfig,eluAlpha:this.net.eluAlpha})})}forward(){this.neurons.forEach((e,t)=>{if("training"==this.state&&(e.dropped=Math.random()>this.net.dropout))e.activation=0;else{e.sum=e.bias;const t=s.getActivations(this.prevLayer);for(let n=0;n<t.length;n++)e.sum+=t[n]*e.weights[n];e.activation=(this.activation?this.activation(e.sum,!1,e):e.sum)/(this.net.dropout||1)}})}backward(e){this.neurons.forEach((t,n)=>{if(t.dropped)t.error=0,t.deltaBias+=0;else{void 0!==e?t.error=e[n]:(t.derivative=this.activation?this.activation(t.sum,!0,t):1,t.error=t.derivative*this.nextLayer.neurons.map(e=>e.error*(e.weights[n]||0)).reduce((e,t)=>e+t,0));const i=s.getActivations(this.prevLayer);for(let e=0;e<t.weights.length;e++)t.deltaWeights[e]+=t.error*i[e];t.deltaBias+=t.error}})}resetDeltaWeights(){for(let e=0;e<this.neurons.length;e++){this.neurons[e].deltaBias=0;for(let t=0;t<this.neurons[e].deltaWeights.length;t++)this.neurons[e].deltaWeights[t]=0}}applyDeltaWeights(){for(let e=0;e<this.neurons.length;e++){const t=this.neurons[e];for(let n=0;n<this.neurons[e].deltaWeights.length;n++){void 0!=this.net.l2Error&&(this.net.l2Error+=.5*this.net.l2*t.weights[n]**2),void 0!=this.net.l1Error&&(this.net.l1Error+=this.net.l1*Math.abs(t.weights[n]));const e=(t.deltaWeights[n]+this.net.l2*t.weights[n]+this.net.l1*(t.weights[n]>0?1:-1))/this.net.miniBatchSize;t.weights[n]=this.net.weightUpdateFn.bind(this.net,t.weights[n],e,t,n)(),void 0!=this.net.maxNorm&&(this.net.maxNormTotal+=t.weights[n]**2)}t.bias=this.net.weightUpdateFn.bind(this.net,t.bias,t.deltaBias,t)()}}backUpValidation(){for(let e=0;e<this.neurons.length;e++){const t=this.neurons[e];t.validationBias=t.bias,t.validationWeights=t.weights.slice(0)}}restoreValidation(){for(let e=0;e<this.neurons.length;e++){const t=this.neurons[e];t.bias=t.validationBias,t.weights=t.validationWeights.slice(0)}}toJSON(){return{weights:this.neurons.map(e=>({bias:e.bias,weights:e.weights}))}}fromJSON(e,t){this.neurons.forEach((n,i)=>{if(e.weights[i].weights.length!=n.weights.length)throw new Error(`Mismatched weights count. Given: ${e.weights[i].weights.length} Existing: ${n.weights.length}. At layers[${t}], neurons[${i}]`);n.bias=e.weights[i].bias,n.weights=e.weights[i].weights})}getDataSize(){let e=0;for(let t=0;t<this.neurons.length;t++)e+=this.neurons[t].weights.length+1;return e}toIMG(){const e=[];for(let t=0;t<this.neurons.length;t++){e.push(this.neurons[t].bias);for(let n=0;n<this.neurons[t].weights.length;n++)e.push(this.neurons[t].weights[n])}return e}fromIMG(e){let t=0;for(let n=0;n<this.neurons.length;n++){const i=this.neurons[n];i.bias=e[t],t++;for(let n=0;n<i.weights.length;n++)i.weights[n]=e[t],t++}}}"undefined"!=typeof window&&(window.FCLayer=window.Layer=i),t.FCLayer=t.Layer=i;class r{constructor(){}init({updateFn:e,activation:t,eluAlpha:n}={}){switch(this.deltaWeights=this.weights.map(e=>e.map(e=>e.map(e=>0))),this.deltaBias=0,e){case"gain":this.biasGain=1,this.weightGains=this.weights.map(e=>e.map(e=>e.map(e=>1))),this.getWeightGain=(([e,t,n])=>this.weightGains[e][t][n]),this.setWeightGain=(([e,t,n],i)=>this.weightGains[e][t][n]=i);break;case"adagrad":case"rmsprop":case"adadelta":case"momentum":this.biasCache=0,this.weightsCache=this.weights.map(e=>e.map(e=>e.map(e=>0))),this.getWeightsCache=(([e,t,n])=>this.weightsCache[e][t][n]),this.setWeightsCache=(([e,t,n],i)=>this.weightsCache[e][t][n]=i),"adadelta"==e&&(this.adadeltaBiasCache=0,this.adadeltaCache=this.weights.map(e=>e.map(e=>e.map(e=>0))),this.getAdadeltaCache=(([e,t,n])=>this.adadeltaCache[e][t][n]),this.setAdadeltaCache=(([e,t,n],i)=>this.adadeltaCache[e][t][n]=i));break;case"adam":this.m=0,this.v=0}"rrelu"==t?this.rreluSlope=.001*Math.random():"elu"==t&&(this.eluAlpha=n)}getWeight([e,t,n]){return this.weights[e][t][n]}setWeight([e,t,n],i){this.weights[e][t][n]=i}getDeltaWeight([e,t,n]){return this.deltaWeights[e][t][n]}setDeltaWeight([e,t,n],i){this.deltaWeights[e][t][n]=i}}"undefined"!=typeof window&&(window.Filter=r),t.Filter=r;class a extends i{constructor(e,{span:t=1}={}){super(e*t*t)}}"undefined"!=typeof window&&(window.InputLayer=a),t.InputLayer=a;class o{static sigmoid(e,t){const n=1/(1+Math.exp(-e));return t?n*(1-n):n}static tanh(e,t){const n=Math.exp(2*e);return t?4/Math.pow(Math.exp(e)+Math.exp(-e),2)||1e-18:(n-1)/(n+1)||1e-18}static relu(e,t){return t?e>0?1:0:Math.max(e,0)}static lrelu(e,t){return t?e>0?1:this.lreluSlope||-5e-4:Math.max((this.lreluSlope||-5e-4)*Math.abs(e),e)}static rrelu(e,t,n){return t?e>0?1:n.rreluSlope:Math.max(n.rreluSlope,e)}static lecuntanh(e,t){return t?1.15333*Math.pow(o.sech(2/3*e),2):1.7159*o.tanh(2/3*e)}static elu(e,t,n){return t?e>=0?1:o.elu(e,!1,n)+n.eluAlpha:e>=0?e:n.eluAlpha*(Math.exp(e)-1)}static crossentropy(e,t){return t.map((t,n)=>e[n]*Math.log(t+1e-15)+(1-e[n])*Math.log(1+1e-15-t)).reduce((e,t)=>e-t,0)}static meansquarederror(e,t){return e.map((e,n)=>Math.pow(e-t[n],2)).reduce((e,t)=>e+t,0)/e.length}static rootmeansquarederror(e,t){return Math.sqrt(o.meansquarederror(e,t))}static vanillasgd(e,t){return e+this.learningRate*t}static gain(e,t,n,i){const r=e+this.learningRate*t*(null==i?n.biasGain:n.getWeightGain(i));return r<=0&&e>0||r>=0&&e<0?null!=i?n.setWeightGain(i,Math.max(.95*n.getWeightGain(i),.5)):n.biasGain=Math.max(.95*n.biasGain,.5):null!=i?n.setWeightGain(i,Math.min(n.getWeightGain(i)+.05,5)):n.biasGain=Math.min(n.biasGain+.05,5),r}static adagrad(e,t,n,i){return null!=i?n.setWeightsCache(i,n.getWeightsCache(i)+Math.pow(t,2)):n.biasCache+=Math.pow(t,2),e+this.learningRate*t/(1e-6+Math.sqrt(null!=i?n.getWeightsCache(i):n.biasCache))}static rmsprop(e,t,n,i){return null!=i?n.setWeightsCache(i,this.rmsDecay*n.getWeightsCache(i)+(1-this.rmsDecay)*Math.pow(t,2)):n.biasCache=this.rmsDecay*n.biasCache+(1-this.rmsDecay)*Math.pow(t,2),e+this.learningRate*t/(1e-6+Math.sqrt(null!=i?n.getWeightsCache(i):n.biasCache))}static adam(e,t,n){n.m=.9*n.m+(1-.9)*t;const i=n.m/(1-Math.pow(.9,this.iterations+1));n.v=.999*n.v+(1-.999)*Math.pow(t,2);const r=n.v/(1-Math.pow(.999,this.iterations+1));return e+this.learningRate*i/(Math.sqrt(r)+1e-8)}static adadelta(e,t,n,i){if(null!=i){n.setWeightsCache(i,this.rho*n.getWeightsCache(i)+(1-this.rho)*Math.pow(t,2));const r=e+Math.sqrt((n.getAdadeltaCache(i)+1e-6)/(n.getWeightsCache(i)+1e-6))*t;return n.setAdadeltaCache(i,this.rho*n.getAdadeltaCache(i)+(1-this.rho)*Math.pow(t,2)),r}{n.biasCache=this.rho*n.biasCache+(1-this.rho)*Math.pow(t,2);const i=e+Math.sqrt((n.adadeltaBiasCache+1e-6)/(n.biasCache+1e-6))*t;return n.adadeltaBiasCache=this.rho*n.adadeltaBiasCache+(1-this.rho)*Math.pow(t,2),i}}static momentum(e,t,n,i){let r;return null!=i?(r=this.momentum*n.getWeightsCache(i)-this.learningRate*t,n.setWeightsCache(i,r)):(r=this.momentum*n.biasCache-this.learningRate*t,n.biasCache=r),e-r}static uniform(e,{limit:t}){const n=[];for(let i=0;i<e;i++)n.push(2*Math.random()*t-t);return n}static gaussian(e,{mean:t,stdDeviation:n}){const i=[];for(let r=0;r<e;r++){let e,r,a;do{a=(e=2*Math.random()-1)**2+(r=2*Math.random()-1)**2}while(a>=1||!a);i.push(t+e*Math.sqrt(-2*Math.log(a)/a)*n)}return i}static xaviernormal(e,{fanIn:t,fanOut:n}){return n||0==n?o.gaussian(e,{mean:0,stdDeviation:Math.sqrt(2/(t+n))}):o.lecunnormal(e,{fanIn:t})}static xavieruniform(e,{fanIn:t,fanOut:n}){return n||0==n?o.uniform(e,{limit:Math.sqrt(6/(t+n))}):o.lecununiform(e,{fanIn:t})}static lecunnormal(e,{fanIn:t}){return o.gaussian(e,{mean:0,stdDeviation:Math.sqrt(1/t)})}static lecununiform(e,{fanIn:t}){return o.uniform(e,{limit:Math.sqrt(3/t)})}static maxPool(e,t){const n=s.getActivations(e.prevLayer,t,e.inMapValuesCount);for(let i=0;i<e.outMapSize;i++)for(let r=0;r<e.outMapSize;r++){const a=i*e.stride,o=r*e.stride;let s=n[a*e.prevLayerOutWidth+o];for(let l=0;l<e.size;l++)for(let u=0;u<e.size;u++){const h=n[(a+l)*e.prevLayerOutWidth+(o+u)];h>s&&(s=h,e.indeces[t][i][r]=[l,u])}e.activations[t][i][r]=s}}static softmax(e){const t=e.slice(0);let n=t[0];for(let e=1;e<t.length;e++)t[e]>n&&(n=t[e]);const i=new Array(t.length);let r=0;for(let e=0;e<t.length;e++){let a=Math.exp(t[e]-n);r+=a,i[e]=a}for(let e=0;e<t.length;e++)i[e]/=r,t[e]=i[e];return t}static sech(e){return 2*Math.exp(-e)/(1+Math.exp(-2*e))}static standardDeviation(e){const t=e.reduce((e,t)=>e+t)/e.length,n=e.map(e=>e-t).map(e=>e**2);return Math.sqrt(n.reduce((e,t)=>e+t)/n.length)}static maxNorm(){if(this.maxNormTotal>this.maxNorm){const e=this.maxNorm/(1e-18+this.maxNormTotal);this.layers.forEach((t,n)=>{n&&t.neurons.forEach(t=>{t.weights.forEach((n,i)=>t.setWeight(i,t.getWeight(i)*e))})})}this.maxNormTotal=0}}"undefined"!=typeof window&&(window.NetMath=o),t.NetMath=o;class s{static format(e,t="string"){switch(!0){case"string"==t&&"string"==typeof e:e=e.replace(/(_|\s)/g,"").toLowerCase();break;case"time"==t&&"number"==typeof e:const n=new Date(e),i=[];e<1e3?i.push(`${n.getMilliseconds()}ms`):e<6e4?i.push(`${n.getSeconds()}.${n.getMilliseconds()}s`):(e>=36e5&&i.push(`${n.getHours()}h`),i.push(`${n.getMinutes()}m`),i.push(`${n.getSeconds()}s`)),e=i.join(" ")}return e}static shuffle(e){for(let t=e.length;t;t--){const n=Math.floor(Math.random()*t),i=e[t-1];e[t-1]=e[n],e[n]=i}}static addZeroPadding(e,t){const n=[];for(let t=0;t<e.length;t++)n.push(e[t].slice(0));const i=[];for(let e=0;e<n.length+2*t;e++)i.push(0);for(let e=0;e<n.length;e++)for(let i=0;i<t;i++)n[e].splice(0,0,0),n[e].splice(n[e].length+1,n[e].length,0);for(let e=0;e<t;e++)n.splice(0,0,i.slice(0)),n.splice(n.length,n.length-1,i.slice(0));return n}static arrayToMap(e,t){const n=[];for(let i=0;i<t;i++){n[i]=[];for(let r=0;r<t;r++)n[i][r]=e[i*t+r]}return n}static arrayToVolume(e,t){const n=[],i=Math.sqrt(e.length/t),r=i**2;for(let t=0;t<Math.floor(e.length/r);t++){const a=[];for(let n=0;n<i;n++){a[n]=[];for(let o=0;o<i;o++)a[n][o]=e[t*r+n*i+o]}n[t]=a}return n}static convolve({input:e,zeroPadding:t,weights:n,channels:i,stride:r,bias:a}){const o=s.arrayToVolume(e,i),l=[],u=o[0].length+2*t,h=Math.floor(n[0].length/2);for(let e=0;e<i;e++){o[e]=s.addZeroPadding(o[e],t);for(let t=h;t<u-h;t+=r){l[(t-h)/r]=l[(t-h)/r]||[];for(let i=h;i<u-h;i+=r){let a=0;for(let r=0;r<n[0].length;r++)for(let s=0;s<n[0].length;s++)a+=o[e][t+(r-h)][i+(s-h)]*n[e][r][s];l[(t-h)/r][(i-h)/r]=(l[(t-h)/r][(i-h)/r]||0)+a}}}for(let e=0;e<l.length;e++)for(let t=0;t<l.length;t++)l[e][t]+=a;return l}static buildConvErrorMap(e,t,n){const i=e.zeroPadding,r=t.length+2*i,a=Math.floor(e.filterSize/2),o=[];for(let e=0;e<r;e++)o.push(0);for(let e=0;e<r;e++)t[e]=o.slice(0);for(let i=0;i<e.size;i++){const o=e.filters[i].weights[n],s=e.filters[i].errorMap;for(let n=a;n<r-a;n+=e.stride)for(let i=a;i<r-a;i+=e.stride)for(let r=0;r<e.filterSize;r++)for(let l=0;l<e.filterSize;l++)t[n+(r-a)][i+(l-a)]+=o[r][l]*s[(n-a)/e.stride][(i-a)/e.stride]}t.splice(0,i),t.splice(t.length-i,t.length);for(let e=0;e<t.length;e++)t[e]=t[e].splice(i,t[e].length-2*i)}static buildConvDWeights(e){const t=e.filters[0].weights[0].length,n=Math.floor(t/2),i=e.filters[0].weights.length;for(let r=0;r<e.filters.length;r++){const a=e.filters[r];for(let r=0;r<i;r++){const i=s.getActivations(e.prevLayer,r,e.inMapValuesCount),o=s.addZeroPadding(s.arrayToMap(i,Math.sqrt(e.inMapValuesCount)),e.zeroPadding);for(let i=n;i<o.length-n;i+=e.stride)for(let s=n;s<o.length-n;s+=e.stride){const l=a.errorMap[(i-n)/e.stride][(s-n)/e.stride];for(let e=0;e<t;e++)for(let u=0;u<t;u++){const t=o[i-n+e][s-n+u];a.deltaWeights[r][e][u]+=t*l}}}for(let e=0;e<a.errorMap.length;e++)for(let t=0;t<a.errorMap.length;t++)a.deltaBias+=a.errorMap[e][t]}}static getActivations(e,t,r){const a=[];if(1==arguments.length)if(e instanceof i)for(let t=0;t<e.neurons.length;t++)a.push(e.neurons[t].activation);else if(e instanceof n)for(let t=0;t<e.filters.length;t++)for(let n=0;n<e.filters[t].activationMap.length;n++)for(let i=0;i<e.filters[t].activationMap[n].length;i++)a.push(e.filters[t].activationMap[n][i]);else for(let t=0;t<e.activations.length;t++)for(let n=0;n<e.activations[0].length;n++)for(let i=0;i<e.activations[0].length;i++)a.push(e.activations[t][n][i]);else if(e instanceof i)for(let n=t*r;n<(t+1)*r;n++)a.push(e.neurons[n].activation);else if(e instanceof n)for(let n=0;n<e.filters[t].activationMap.length;n++)for(let i=0;i<e.filters[t].activationMap[n].length;i++)a.push(e.filters[t].activationMap[n][i]);else for(let n=0;n<e.activations[t].length;n++)for(let i=0;i<e.activations[t].length;i++)a.push(e.activations[t][n][i]);return a}static splitData(e,{training:t=.7,validation:n=.15,test:i=.15}={}){const r={training:[],validation:[],test:[]};for(let i=0;i<e.length;i++){let a=Math.random();a>1-t?r.training.push(e[i]):a<n?r.validation.push(e[i]):r.test.push(e[i])}return r}static normalize(e){let t=1/0,n=-1/0;for(let i=0;i<e.length;i++)e[i]<t&&(t=e[i]),e[i]>n&&(n=e[i]);if(-1*t+n!=0)for(let i=0;i<e.length;i++)e[i]=(e[i]+-1*t)/(-1*t+n);else for(let t=0;t<e.length;t++)e[t]=.5;return{minVal:t,maxVal:n}}static makeConfusionMatrix(e){let t=0,n=0;const i=[];for(let t=0;t<e.length;t++){const n=[];for(let i=0;i<e[t].length;i++)n.push(e[t][i]);i.push(n)}for(let e=0;e<i.length;e++)for(let n=0;n<i[e].length;n++)t+=i[e][n];for(let e=0;e<i.length;e++){let r=0;n+=i[e][e];for(let n=0;n<i[e].length;n++)r+=i[e][n],i[e][n]={count:i[e][n],percent:i[e][n]/t*100||0};const a=i[e][e].count/r*100;i[e].total={correct:a||0,wrong:100-a||0}}const r=[];for(let e=0;e<i[0].length;e++){let t=0;for(let n=0;n<i.length;n++)t+=i[n][e].count;const n=i[e][e].count/t*100;r.push({correct:n||0,wrong:100-n||0})}return i.total=r,i.total.total={correct:n/t*100||0,wrong:100-n/t*100||0},i}static printConfusionMatrix(t){if("undefined"!=typeof window){for(let e=0;e<t.length;e++){for(let n=0;n<t[e].length;n++)t[e][n]=`${t[e][n].count} (${t[e][n].percent.toFixed(1)}%)`;t[e].total=`${t[e].total.correct.toFixed(1)}% / ${t[e].total.wrong.toFixed(1)}%`,t.total[e]=`${t.total[e].correct.toFixed(1)}% / ${t.total[e].wrong.toFixed(1)}%`}return t.total.total=`${t.total.total.correct.toFixed(1)}% / ${t.total.total.wrong.toFixed(1)}%`,void console.table(t)}const n=(e,t)=>{e=t?e.toFixed(1)+"%":e.toString();const n=Math.max(Math.floor((7-e.length)/2),0),i=Math.max(7-(e.length+n),0);return" ".repeat(n)+e+" ".repeat(i)};let i,r;e.stdout.write("\n[1m");for(let a=0;a<t.length;a++){i="[2m[37m";for(let o=0;o<t[a].length;o++)r=a==o?"[42m":"[41m",e.stdout.write(`${i}${r}[1m${n(t[a][o].count)}[22m`);i="[2m[32m",r="[47m",e.stdout.write(`${i}${r}${n(t[a].total.correct,!0)}`),i="[2m[37m",e.stdout.write(`${i}\n`);for(let o=0;o<t[a].length;o++)r=a==o?"[42m":"[41m",e.stdout.write(`${i}${r}${n(t[a][o].percent,!0)}`);i="[2m[31m",r="[47m",e.stdout.write(`${i}${r}${n(t[a].total.wrong,!0)}`),e.stdout.write("[1m[30m\n")}i="[22m[32m";for(const a of t.total)e.stdout.write(`${i}${r}${n(a.correct,!0)}`);r="[1m[44m",e.stdout.write(`${i}${r}${n(t.total.total.correct,!0)}\n`),i="[22m[31m",r="[47m";for(const a of t.total)e.stdout.write(`${i}${r}${n(a.wrong,!0)}`);i="[1m[31m",r="[44m",e.stdout.write(`${i}${r}${n(t.total.total.wrong,!0)}\n`),e.stdout.write("[0m\n")}}"undefined"!=typeof window&&(window.NetUtil=s),t.NetUtil=s;class l{constructor({learningRate:e,layers:t=[],updateFn:r="vanillasgd",activation:a="sigmoid",cost:l="meansquarederror",momentum:u=.9,rmsDecay:c,rho:d,lreluSlope:_,eluAlpha:p,dropout:f=1,l2:g,l1:m,maxNorm:M,weightsConfig:y,channels:v,conv:E,pool:w}={}){switch(this.state="not-defined",this.layers=[],this.conv={},this.pool={},this.epochs=0,this.iterations=0,this.validations=0,this.dropout=0==f?1:f,this.error=0,a=s.format(a),r=s.format(r),l=s.format(l),this.l1=0,this.l2=0,m&&(this.l1="boolean"==typeof m?.005:m,this.l1Error=0),g&&(this.l2="boolean"==typeof g?.001:g,this.l2Error=0),M&&(this.maxNorm="boolean"==typeof M&&M?1e3:M,this.maxNormTotal=0),e&&(this.learningRate=e),v&&(this.channels=v),E&&(void 0!=E.filterSize&&(this.conv.filterSize=E.filterSize),void 0!=E.zeroPadding&&(this.conv.zeroPadding=E.zeroPadding),void 0!=E.stride&&(this.conv.stride=E.stride)),w&&(w.size&&(this.pool.size=w.size),w.stride&&(this.pool.stride=w.stride)),r){case"rmsprop":this.learningRate=void 0==this.learningRate?.001:this.learningRate;break;case"adam":this.learningRate=void 0==this.learningRate?.01:this.learningRate;break;case"momentum":this.learningRate=void 0==this.learningRate?.2:this.learningRate,this.momentum=u;break;case"adadelta":this.rho=null==d?.95:d;break;default:if(void 0==this.learningRate)switch(a){case"relu":case"lrelu":case"rrelu":case"elu":this.learningRate=.01;break;case"tanh":case"lecuntanh":this.learningRate=.001;break;default:this.learningRate=.2}}if(this.updateFn=[!1,null,void 0].includes(r)?"vanillasgd":r,this.weightUpdateFn=o[this.updateFn],this.activation="function"==typeof a?a:o[a].bind(this),this.activationConfig=a,this.cost="function"==typeof l?l:o[l],"rmsprop"==this.updateFn&&(this.rmsDecay=void 0==c?.99:c),this.lreluSlope=void 0==_?-5e-4:_,this.rreluSlope=.001*Math.random(),this.eluAlpha=void 0==p?1:p,this.weightsConfig={distribution:"xavieruniform"},void 0!=y&&y.distribution&&(this.weightsConfig.distribution=s.format(y.distribution)),"uniform"==this.weightsConfig.distribution?this.weightsConfig.limit=y&&void 0!=y.limit?y.limit:.1:"gaussian"==this.weightsConfig.distribution&&(this.weightsConfig.mean=y.mean||0,this.weightsConfig.stdDeviation=y.stdDeviation||.05),"function"==typeof this.weightsConfig.distribution?this.weightsInitFn=this.weightsConfig.distribution:this.weightsInitFn=o[this.weightsConfig.distribution],t.length)switch(!0){case t.every(e=>Number.isInteger(e)):this.layers=t.map(e=>new i(e)),this.state="constructed",this.initLayers();break;case t.every(e=>e instanceof i||e instanceof n||e instanceof h):this.state="constructed",this.layers=t,this.initLayers();break;default:throw new Error("There was an error constructing from the layers given.")}this.collectedErrors={training:[],validation:[],test:[]}}initLayers(e,t){switch(this.state){case"initialised":return;case"not-defined":this.layers[0]=new i(e),this.layers[1]=new i(Math.ceil(e/t>5?t+Math.abs(e-t)/4:e+t)),this.layers[2]=new i(Math.ceil(t))}this.layers.forEach(this.joinLayer.bind(this));const n=this.layers[this.layers.length-1].size;this.trainingConfusionMatrix=[...new Array(n)].map(e=>[...new Array(n)].map(e=>0)),this.testConfusionMatrix=[...new Array(n)].map(e=>[...new Array(n)].map(e=>0)),this.validationConfusionMatrix=[...new Array(n)].map(e=>[...new Array(n)].map(e=>0)),this.state="initialised"}joinLayer(e,t){e.net=this,e.activation=void 0==e.activation?this.activation:e.activation,e.weightsConfig={},Object.assign(e.weightsConfig,this.weightsConfig),t?(this.layers[t-1].assignNext(e),e.assignPrev(this.layers[t-1],t),e.weightsConfig.fanIn=e.prevLayer.size,t<this.layers.length-1&&(e.weightsConfig.fanOut=this.layers[t+1].size),e.init()):this.layers.length>1&&(e.weightsConfig.fanOut=this.layers[1].size),e.state="initialised"}forward(e){if("initialised"!=this.state)throw new Error("The network layers have not been initialised.");if(void 0===e||null===e)throw new Error("No data passed to Network.forward()");if(Array.isArray(e[0])){const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[0].length;i++)for(let r=0;r<e[0].length;r++)t.push(e[n][i][r]);e=t}e.length!=this.layers[0].neurons.length&&console.warn("Input data length did not match input layer neurons count."),this.layers[0].neurons.forEach((t,n)=>t.activation=e[n]),this.layers.forEach((e,t)=>t&&e.forward());const t=this.layers[this.layers.length-1].neurons.map(e=>e.sum);return t.length>1?o.softmax(t):t}backward(e){if(void 0===e)throw new Error("No data passed to Network.backward()");e.length!=this.layers[this.layers.length-1].neurons.length&&console.warn("Expected data length did not match output layer neurons count.",e),this.layers[this.layers.length-1].backward(e);for(let e=this.layers.length-2;e>0;e--)this.layers[e].backward()}train(e,{epochs:t=1,callback:n,callbackInterval:i=1,collectErrors:r,log:a=!0,miniBatchSize:o=1,shuffle:l=!1,validation:u}={}){return this.miniBatchSize="boolean"==typeof o&&o?e[0].expected.length:o,this.validation=u,new Promise((o,h)=>{if(l&&s.shuffle(e),a&&console.log(`Training started. Epochs: ${t} Batch Size: ${this.miniBatchSize}`),void 0===e||null===e)return void h("No data provided");if("initialised"!=this.state&&this.initLayers.bind(this,e[0].input.length,e[0].expected.length)(),this.layers.forEach(e=>e.state="training"),this.validation&&(this.validation.interval=this.validation.interval||e.length,this.validation.earlyStopping))switch(this.validation.earlyStopping.type){case"threshold":this.validation.earlyStopping.threshold=this.validation.earlyStopping.threshold||.01;break;case"patience":this.validation.earlyStopping.patienceCounter=0,this.validation.earlyStopping.bestError=1/0,this.validation.earlyStopping.patience=this.validation.earlyStopping.patience||20;break;case"divergence":this.validation.earlyStopping.percent=this.validation.earlyStopping.percent||30,this.validation.earlyStopping.bestError=1/0}let c,d=0,_=0;const p=Date.now(),f=()=>{if(this.layers.forEach(e=>e.state="initialised"),this.validation&&this.validation.earlyStopping&&("patience"==this.validation.earlyStopping.type||"divergence"==this.validation.earlyStopping.type))for(let e=1;e<this.layers.length;e++)this.layers[e].restoreValidation();a&&console.log(`Training finished. Total time: ${s.format(c,"time")}  Average iteration time: ${s.format(c/d,"time")}`),o()},g=()=>{this.epochs++,this.error=0,this.validationError=0,d=0,void 0!=this.l2Error&&(this.l2Error=0),void 0!=this.l1Error&&(this.l1Error=0),m()},m=async()=>{if(!e[d].hasOwnProperty("input")||!e[d].hasOwnProperty("expected"))return void h("Data set must be a list of objects with keys: 'input' and 'expected'");let o,l;const M=e[d].input,y=this.forward(M),v=e[d].expected;let E=-1/0;const w=[];for(let e=0;e<y.length;e++)w[e]=(1==v[e]?1:0)-y[e],E=Math.max(E,y[e]);if(this.trainingConfusionMatrix[v.indexOf(1)]&&this.trainingConfusionMatrix[v.indexOf(1)][y.indexOf(E)]++,this.validation&&d&&d%this.validation.interval==0&&(l=await this.validate(this.validation.data),this.validation.earlyStopping&&this.checkEarlyStopping(w)))return a&&console.log("Stopping early"),f();if(this.backward(w),++d%this.miniBatchSize==0?(this.applyDeltaWeights(),this.resetDeltaWeights()):d>=e.length&&this.applyDeltaWeights(),o=this.cost(v,y),this.error+=o,this.iterations++,c=Date.now()-p,r&&(this.collectedErrors.training.push(o),l&&this.collectedErrors.validation.push(l)),d%i!=0&&!l||"function"!=typeof n||n({iterations:this.iterations,validations:this.validations,validationError:l,trainingError:o,elapsed:c,input:M}),d<e.length)d%i==0?setTimeout(m.bind(this),0):m();else{if(_++,a){let e=`Epoch: ${this.epochs}\nTraining Error: ${this.error/d}`;u&&(e+=`\nValidation Error: ${this.validationError}`),void 0!=this.l2Error&&(e+=`\nL2 Error: ${this.l2Error/d}`),e+=`\nElapsed: ${s.format(c,"time")} Average Duration: ${s.format(c/_,"time")}`,console.log(e)}_<t?g():f()}};this.resetDeltaWeights(),g()})}validate(e){return new Promise((t,n)=>{let i=0,r=0;const a=n=>{const o=this.forward(e[i].input),s=e[i].expected;let l=-1/0;for(let e=0;e<o.length;e++)l=Math.max(l,o[e]);this.validationConfusionMatrix[s.indexOf(1)]&&this.validationConfusionMatrix[s.indexOf(1)][o.indexOf(l)]++,this.validations++,r+=this.cost(s,o),this.validationError=r/(i+1),++i<e.length?setTimeout(()=>a(i),0):(this.lastValidationError=r/e.length,t(r/e.length))};a(i)})}checkEarlyStopping(e){let t=!1;switch(this.validation.earlyStopping.type){case"threshold":return(t=this.lastValidationError<=this.validation.earlyStopping.threshold)&&(this.backward(e),this.applyDeltaWeights()),t;case"patience":if(this.lastValidationError<this.validation.earlyStopping.bestError){this.validation.earlyStopping.patienceCounter=0,this.validation.earlyStopping.bestError=this.lastValidationError;for(let e=1;e<this.layers.length;e++)this.layers[e].backUpValidation()}else this.validation.earlyStopping.patienceCounter++,t=this.validation.earlyStopping.patienceCounter>=this.validation.earlyStopping.patience;return t;case"divergence":if(this.lastValidationError<this.validation.earlyStopping.bestError){this.validation.earlyStopping.bestError=this.lastValidationError;for(let e=1;e<this.layers.length;e++)this.layers[e].backUpValidation()}else t=this.lastValidationError/this.validation.earlyStopping.bestError>=1+this.validation.earlyStopping.percent/100;return t}}test(e,{log:t=!0,callback:n,collectErrors:i}={}){return new Promise((r,a)=>{void 0!==e&&null!==e||a("No data provided"),t&&console.log("Testing started");let o=0,l=0;const u=Date.now(),h=()=>{const a=e[l].input,c=this.forward(a),d=e[l].expected,_=Date.now()-u;let p=-1/0;for(let e=0;e<c.length;e++)p=Math.max(p,c[e]);this.testConfusionMatrix[d.indexOf(1)]&&this.testConfusionMatrix[d.indexOf(1)][c.indexOf(p)]++;const f=this.cost(d,c);o+=f,l++,i&&this.collectedErrors.test.push(f),"function"==typeof n&&n({iterations:l,error:f,elapsed:_,input:a}),l<e.length?setTimeout(h.bind(this),0):(t&&console.log(`Testing finished. Total time: ${s.format(_,"time")}  Average iteration time: ${s.format(_/l,"time")}`),r(o/e.length))};h()})}resetDeltaWeights(){this.layers.forEach((e,t)=>t&&e.resetDeltaWeights())}applyDeltaWeights(){this.layers.forEach((e,t)=>t&&e.applyDeltaWeights()),void 0!=this.maxNorm&&(this.maxNormTotal=Math.sqrt(this.maxNormTotal),o.maxNorm.bind(this)())}toJSON(){return{layers:this.layers.map(e=>e.toJSON())}}fromJSON(e){if(void 0===e||null===e)throw new Error("No JSON data given to import.");if(e.layers.length!=this.layers.length)throw new Error(`Mismatched layers (${e.layers.length} layers in import data, but ${this.layers.length} configured)`);this.resetDeltaWeights(),this.layers.forEach((t,n)=>n&&t.fromJSON(e.layers[n],n))}toIMG(e,t={}){if(!e)throw new Error("The IMGArrays library must be provided. See the documentation for instructions.");const n=[];for(let e=1;e<this.layers.length;e++){const t=this.layers[e].toIMG();for(let e=0;e<t.length;e++)n.push(t[e])}return e.toIMG(n,t)}fromIMG(e,t,n={}){if(!t)throw new Error("The IMGArrays library must be provided. See the documentation for instructions.");const i=t.fromIMG(e,n);for(let e=1;e<this.layers.length;e++){const t=this.layers[e].getDataSize();this.layers[e].fromIMG(i.splice(0,t))}}printConfusionMatrix(e){if(e)s.printConfusionMatrix(s.makeConfusionMatrix(this[`${e}ConfusionMatrix`]));else{const e=[];for(let t=0;t<this.trainingConfusionMatrix.length;t++){const n=[];for(let e=0;e<this.trainingConfusionMatrix.length;e++)n.push(this.trainingConfusionMatrix[t][e]+this.testConfusionMatrix[t][e]+this.validationConfusionMatrix[t][e]);e.push(n)}s.printConfusionMatrix(s.makeConfusionMatrix(e))}}static get version(){return"3.3.0"}}"undefined"!=typeof window&&(window.Network=l),t.Network=l;class u{constructor(){}init({updateFn:e,activation:t,eluAlpha:n}={}){const i=this.weights.length;switch(this.deltaWeights=this.weights.map(e=>0),e){case"gain":this.biasGain=1,this.weightGains=[...new Array(i)].map(e=>1),this.getWeightGain=(e=>this.weightGains[e]),this.setWeightGain=((e,t)=>this.weightGains[e]=t);break;case"adagrad":case"rmsprop":case"adadelta":case"momentum":this.biasCache=0,this.weightsCache=[...new Array(i)].map(e=>0),this.getWeightsCache=(e=>this.weightsCache[e]),this.setWeightsCache=((e,t)=>this.weightsCache[e]=t),"adadelta"==e&&(this.adadeltaBiasCache=0,this.adadeltaCache=[...new Array(i)].map(e=>0),this.getAdadeltaCache=(e=>this.adadeltaCache[e]),this.setAdadeltaCache=((e,t)=>this.adadeltaCache[e]=t));break;case"adam":this.m=0,this.v=0}"rrelu"==t?this.rreluSlope=.001*Math.random():"elu"==t&&(this.eluAlpha=n)}getWeight(e){return this.weights[e]}setWeight(e,t){this.weights[e]=t}getDeltaWeight(e){return this.deltaWeights[e]}setDeltaWeight(e,t){this.deltaWeights[e]=t}}"undefined"!=typeof window&&(window.Neuron=u),t.Neuron=u;class h{constructor(e,{stride:t,activation:n}={}){e&&(this.size=e),t&&(this.stride=t),this.activation=void 0!=n&&0!=n&&("function"==typeof n?n:o[s.format(n)].bind(this))}init(){}assignNext(e){this.nextLayer=e}assignPrev(e,t){this.prevLayer=e,this.size=this.size||this.net.pool.size||2,this.stride=this.stride||this.net.pool.stride||this.size,this.layerIndex=t;let n=e.outMapSize;switch(e.constructor.name){case"FCLayer":this.channels=this.net.channels,n=Math.max(Math.floor(Math.sqrt(e.size/this.channels)),1);break;case"ConvLayer":this.channels=e.size;break;case"PoolLayer":this.channels=e.channels}if(this.prevLayerOutWidth=n,this.outMapSize=(n-this.size)/this.stride+1,this.inMapValuesCount=n**2,this.outMapSize%1!=0)throw new Error(`Misconfigured hyperparameters. Activation volume dimensions would be ${this.outMapSize} in pool layer at index ${t}`);this.activations=[...new Array(this.channels)].map(e=>[...new Array(this.outMapSize)].map(e=>[...new Array(this.outMapSize)].map(e=>0))),this.errors=[...new Array(this.channels)].map(e=>[...new Array(n)].map(e=>[...new Array(n)].map(e=>0))),this.indeces=this.activations.map(e=>e.map(e=>e.map(e=>[0,0])))}forward(){for(let e=0;e<this.channels;e++)if(o.maxPool(this,e),this.activation)for(let t=0;t<this.outMapSize;t++)for(let n=0;n<this.outMapSize;n++)this.activations[e][t][n]=this.activation(this.activations[e][t][n],!1,this.net)}backward(){for(let e=0;e<this.channels;e++)for(let t=0;t<this.errors[0].length;t++)for(let n=0;n<this.errors[0].length;n++)this.errors[e][t][n]=0;if(this.nextLayer instanceof i)for(let e=0;e<this.channels;e++)for(let t=0;t<this.outMapSize;t++)for(let n=0;n<this.outMapSize;n++){const i=this.indeces[e][t][n][0]+t*this.stride,r=this.indeces[e][t][n][1]+n*this.stride,a=e*this.outMapSize**2+t*this.outMapSize+n;for(let t=0;t<this.nextLayer.neurons.length;t++)this.errors[e][i][r]+=this.nextLayer.neurons[t].error*this.nextLayer.neurons[t].weights[a]}else if(this.nextLayer instanceof n)for(let e=0;e<this.channels;e++){const t=[];for(let e=0;e<this.outMapSize;e++)t[e]=0;s.buildConvErrorMap(this.nextLayer,t,e);for(let n=0;n<this.outMapSize;n++)for(let i=0;i<this.outMapSize;i++){const r=this.indeces[e][n][i][0]+n*this.stride,a=this.indeces[e][n][i][1]+i*this.stride;this.errors[e][r][a]+=t[n][i]}}else for(let e=0;e<this.channels;e++)for(let t=0;t<this.outMapSize;t++)for(let n=0;n<this.outMapSize;n++){const i=this.indeces[e][t][n][0]+t*this.stride,r=this.indeces[e][t][n][1]+n*this.stride;this.errors[e][i][r]+=this.nextLayer.errors[e][t][n]}if(this.activation)for(let e=0;e<this.channels;e++)for(let t=0;t<this.indeces[e].length;t++)for(let n=0;n<this.indeces[e].length;n++){const i=this.indeces[e][t][n][0]+t*this.stride,r=this.indeces[e][t][n][1]+n*this.stride;this.errors[e][i][r]*=this.activation(this.errors[e][i][r],!0,this.net)}}resetDeltaWeights(){}applyDeltaWeights(){}backUpValidation(){}restoreValidation(){}toJSON(){return{}}fromJSON(){}getDataSize(){return 0}toIMG(){return[]}fromIMG(){}}"undefined"!=typeof window&&(window.PoolLayer=h),t.PoolLayer=h}).call(this,n(0))},function(e,t,n){"use strict";n.r(t);var i=n(1),r=n.n(i);const{Network:a,Layer:o,FCLayer:s,ConvLayer:l,PoolLayer:u,Filter:h,Neuron:c,NetMath:d,NetUtil:_}=r.a.webassembly();window.addEventListener("jsNetWASMLoaded",()=>{console.log("jsnet",r.a),console.log("Module",Module),window.net=new a({Module:Module,layers:[2,3,4]}),console.log("net",window.net)})}]);